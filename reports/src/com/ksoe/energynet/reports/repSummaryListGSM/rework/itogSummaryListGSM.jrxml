<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="itogSummaryListGSM" pageWidth="855" pageHeight="20" orientation="Landscape" whenNoDataType="AllSectionsNoDetail" columnWidth="855" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" isIgnorePagination="true">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="1.3310000000000006"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="molcode" class="java.lang.String">
		<parameterDescription><![CDATA[код мола]]></parameterDescription>
		<defaultValueExpression><![CDATA[new String("1021")]]></defaultValueExpression>
	</parameter>
	<parameter name="typefuel" class="java.lang.Integer">
		<parameterDescription><![CDATA[1- бензин
2- ДТ]]></parameterDescription>
		<defaultValueExpression><![CDATA[new Integer(1)]]></defaultValueExpression>
	</parameter>
	<parameter name="actstatus" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new Integer(1)]]></defaultValueExpression>
	</parameter>
	<parameter name="dateStart" class="java.lang.String"/>
	<parameter name="dateFinal" class="java.lang.String"/>
	<queryString>
		<![CDATA[select  final_q.fuelname, final_q.nn_general, final_q.matname_general,
sum(sumquantityrash)::numeric(15,2) as sumquantityrash,
sum(sumcost)::numeric(15,2) as sumcost,
sum(quantity_other)::numeric(15,2) as quantity_other,
sum(quantity_energosbyt)::numeric(15,2) as quantity_energosbyt, sum(quantity_kapstr)::numeric(15,2) as quantity_kapstr,
sum(quantity_rm)::numeric(15,2) as quantity_rm, sum(quantity_ktrem)::numeric(15,2) as quantity_ktrem,
sum(quantity_tho)::numeric(15,2) as quantity_tho, sum(quantity_usl)::numeric(15,2) as quantity_usl,
sum(quantity_dem)::numeric(15,2) as quantity_dem, sum(fuelGPS_globus)::numeric(15,2) as fuelGPS_globus,
sum(count_in)::numeric(15,2) as count_in, sum(countgenstart)::numeric(15,2) as countgenstart,
sum(countgenfinal)::numeric(15,2) as countgenfinal, sum(countgenfinal_sub)::numeric(15,2) as countgenfinal_sub from

(
select ' '||trinvnumber as trinvnumber, trgosnumber, trim(trname) as trname, fuelname,
nn_general, matname_general, sumquantityrash, sumcost, quantity_other, quantity_energosbyt, quantity_kapstr,
quantity_rm, quantity_ktrem, quantity_tho, quantity_usl, quantity_dem,
coalesce(fuelGPS_globus,0) as fuelGPS_globus,  coalesce(count_in,0) as count_in, coalesce(count_out,0) as count_out,
    coalesce(first_count_start, prev_count_final, 0) as countgenstart,
    coalesce(last_count_final, prev_count_final, 0) as countgenfinal_from_trvchet,

      coalesce(first_count_start, prev_count_final, 0) + coalesce(count_in,0) - coalesce(sumquantityrash,0) as countgenfinal,
      coalesce(first_count_start, prev_count_final, 0) + coalesce(count_in,0) - coalesce(sumquantityrash,0) - coalesce(last_count_final, prev_count_final, 0) as countgenfinal_sub,

       fueltypecode
    from
(
select TTT.nn_general ,  TTT.matname_general, coalesce(TTT.sumquantityrash,0) as sumquantityrash,
coalesce(TTT.sumcost,0) as sumcost,
coalesce(TTT.quantity_other,0) as quantity_other, coalesce(TTT.quantity_energosbyt,0) as quantity_energosbyt,
coalesce(TTT.quantity_kapstr,0) as quantity_kapstr, coalesce(TTT.quantity_rm,0) as quantity_rm,
coalesce(TTT.quantity_ktrem,0) as quantity_ktrem, coalesce(TTT.quantity_tho,0) as quantity_tho,
coalesce(TTT.quantity_usl, 0) as quantity_usl, coalesce(TTT.quantity_dem,0) as quantity_dem,

    (select trr.invnumber from tktransportreal trr
    where trr.code = transport_history.transportrealrefcode ) as trinvnumber,
        (select trr.gosnumber from tktransportreal trr
    where trr.code = transport_history.transportrealrefcode ) as trgosnumber,
        (select trr.name from tktransportreal trr
    where trr.code = transport_history.transportrealrefcode ) as trname,

    (select name from tkfueltype ttf where ttf.code = transport_history.fueltypecode) as fuelname,

 transport_history.fueltypecode as fueltypecode,

( select sum(eni.countfact) as pmm
from tktransportrealhistory h  , tktransportreal tr , entravelsheet trav , entravelsheetitem travi ,
entravlshttm2trnsprttm  , entransport2enestimate t2e , enestimateitem eni , tkfueltype , enplanwork p
      where h.transportrealrefcode = tr.code
      and tr.code = trav.transportrealcode
      and p.datestart between to_date( $P{dateStart}, 'dd.mm.yyyy') and  to_date( $P{dateFinal} , 'dd.mm.yyyy')
      and trav.datestart between h.datestart and coalesce(h.datefinal,'01.01.2999')
      and trav.code = travi.travelsheetrefcode
      and travi.code = entravlshttm2trnsprttm.travelsheetitemrefcode
      and t2e.transportrefcode = entravlshttm2trnsprttm.transportitemrefcode
      and t2e.estimaterefcode = eni.code
      and eni.kindrefcode = 2
      and travi.kindrefcode = 2
      and h.reg_id is not null
      and tkfueltype.materialrefcode = eni.materialrefcode
      and tkfueltype.code =  transport_history.fueltypecode
      and eni.planrefcode = p.code
      and net.get_transport_real_mol(trav.transportrealcode,trav.datestart) = transport_history.finmolcode
      and tr.code = transport_history.transportrealrefcode
      ) as fuelGPS_globus ,
-- первый остаток в этом месяце
(select fr.countgenstart
	from entravelsheet ts inner join entravelsheetfuelremns fr
	on fr.travelsheetrefcode = ts.code
	where fr.realtransportcode = transport_history.transportrealrefcode
	and fr.dategen between transport_history.datestart and  transport_history.dateend
	and fr.fueltyperefcode = transport_history.fueltypecode
    and net.get_transport_real_mol(fr.realtransportcode,fr.dategen) = transport_history.finmolcode
	order by ts.datestart, ts.timestart limit 1)
    as first_count_start,

-- последний остаток в этом месяце
(select fr.countgenfinal
	from entravelsheet ts inner join entravelsheetfuelremns fr
	on fr.travelsheetrefcode = ts.code
	where fr.realtransportcode = transport_history.transportrealrefcode
	and fr.dategen between transport_history.datestart and  transport_history.dateend
	and fr.fueltyperefcode = transport_history.fueltypecode
	order by ts.datefinal DESC, ts.timefinal DESC limit 1)
    as last_count_final,

-- последний остаток из прошлых месяцев
-- (будет использован, если в этом месяце не было ПЛ для этой машины)
(select fr.countgenfinal
	from entravelsheet ts inner join entravelsheetfuelremns fr
	on fr.travelsheetrefcode = ts.code
	where fr.realtransportcode = transport_history.transportrealrefcode
	and fr.dategen < transport_history.datestart
	and fr.fueltyperefcode = transport_history.fueltypecode
	order by ts.datefinal DESC, ts.timefinal DESC limit 1)
    as prev_count_final,


-- приходы и расходы
(select sum(fr.countgenin)
	from entravelsheetfuelremns fr
	where fr.realtransportcode = transport_history.transportrealrefcode
    and fr.dategen between transport_history.datestart and  transport_history.dateend
    and net.get_transport_real_mol(fr.realtransportcode,fr.dategen) = transport_history.finmolcode
    and fr.fueltyperefcode = transport_history.fueltypecode)
    as count_in,

(select sum(fr.countgenout)
	from entravelsheetfuelremns fr
	where fr.realtransportcode = transport_history.transportrealrefcode
    and fr.dategen between transport_history.datestart and  transport_history.dateend
    and net.get_transport_real_mol(fr.realtransportcode,fr.dategen) = transport_history.finmolcode
    and fr.fueltyperefcode = transport_history.fueltypecode)
    as count_out

     from
(
select trcode, ftcode,  nn_general
, matname_general
, coalesce(sum(quantity),0) as sumquantityrash
, coalesce(sum(sumcost),0) as sumcost
, coalesce(sum(quantity * is_other),0) as quantity_other
, coalesce(sum(quantity * is_energosbyt),0) as quantity_energosbyt
, coalesce(sum(quantity * is_kapstr),0) as quantity_kapstr
, coalesce(sum(quantity * is_rm),0) as quantity_rm
, coalesce(sum(quantity * is_ktrem),0) as quantity_ktrem
, coalesce(sum(quantity * is_tho),0) as quantity_tho
, coalesce(sum(quantity * is_usl),0) as quantity_usl
, coalesce(sum(quantity * is_dem),0) as quantity_dem

from

(select  trcode, ftcode, nn_general, matname_general, quantity, sumcost,
case when acttyperefcode not in (4,2,1,5,3,7,9,19) /*расход типу акта для прочих типов актов  */
  	and budgetrefcode not in (500000000,75000011,240000001)
	then 1 else null end as is_other,
case when acttyperefcode not in (7,9) /*не услуги на сторону  */
	and budgetrefcode = 240000001
	then 1 else null end as is_energosbyt,
case when acttyperefcode = 4 /*расход типу акта по кап строительству */
    and budgetrefcode not in (500000000,75000011,240000001)
	then 1 else null end as is_kapstr,
case when acttyperefcode = 2 /*расход типу акта реконструкция и модернизация */
	and budgetrefcode not in (500000000,75000011,240000001)
	then 1 else null end as is_rm,
case when acttyperefcode in (1,5) /*расход типу акта капитальный и текущий ремонты */
	and budgetrefcode not in (500000000,75000011,240000001)
	then 1 else null end as is_ktrem,
case when acttyperefcode = 3 /*расход типу акта : техническое обслуживание */
	and budgetrefcode not in (500000000,75000011,240000001)
	then 1 else null end as is_tho,
case when (acttyperefcode in (7,9))  /*расход типу акта : работы на сторону и ТУ */
	or  (budgetrefcode in (500000000,75000011)) /*или не равно энергосбыту или ВПТУ и ВРТУ */
	then 1 else null end as is_usl,
case when acttyperefcode = 19 /*расход типу акта : по демонтажу */
	and budgetrefcode not in (500000000,75000011,240000001)
	then 1 else null end as is_dem
from

(Select
trr.code as trcode
, ft.code as ftcode
, finm.nn as nn_general
, finm.mat_name as matname_general
, act.acttyperefcode as acttyperefcode
, pw.budgetrefcode as budgetrefcode
, sum(finm.quantity) as quantity
, sum(finm.cost) as sumcost
From entravelsheet trsh
	inner join entravelsheetitem trshi on trsh.code = trshi.travelsheetrefcode
	inner join entravlshttm2trnsprttm trshi2entri on trshi.code = trshi2entri.travelsheetitemrefcode
	inner join entransport2enestimate entri2eni on trshi2entri.transportitemrefcode = entri2eni.transportrefcode
	inner join enestimateitem eni on eni.code = entri2eni.estimaterefcode
	inner join finmaterials finm on finm.estimateitemrefcode = entri2eni.estimaterefcode
	left join enact2enplanwork act2plan on trshi.planrefcode = act2plan.plancode
	left join enact act on act.code = act2plan.actrefcode
	inner join tkfueltype ft on ft.materialrefcode = eni.materialrefcode
	inner join enplanwork pw on trshi.planrefcode = pw.code
	inner join tktransportreal trr on trsh.transportrealcode = trr.code
Where
	trshi.kindrefcode = 2
	and finm.statusrefcode = 1
	and finm.div_code = $P{molcode}
	and ((act.statusrefcode = 3 /*проведеные*/ and 1 = $P{actstatus} ) or
		(act.statusrefcode in (1,3,4) /*проведеные и черновые и на подписании*/ and 2 = $P{actstatus} ))
	and pw.datestart between to_date( $P{dateStart}, 'dd.mm.yyyy') and  to_date( $P{dateFinal}, 'dd.mm.yyyy')
Group by trr.code, ft.code , finm.nn  , finm.mat_name,  act.acttyperefcode, pw.budgetrefcode
) T
) TT
group by trcode, ftcode, nn_general, matname_general
) TTT  right join
(select
	/*Код автотранспорта*/
     tktransportrealhistory.transportrealrefcode,
     /*Начало срока владения этого автотранспорта этим МОЛом в этом месяце*/
    min(case
    	when datestart >= to_date(param.dStart, 'dd.mm.yyyy')
        	and (select trh1.finmolcode from tktransportrealhistory as trh1 where trh1.code =  tktransportrealhistory.parentrefcode) != tktransportrealhistory.finmolcode
        then datestart
     	else to_date(param.dStart, 'dd.mm.yyyy')
    end) as datestart,
    /*Конец срока владения этого автотранспорта этим МОЛом в этом месяце*/
    max(case
    	when coalesce(datefinal, to_date(param.dEnd, 'dd.mm.yyyy')) <= to_date(param.dEnd, 'dd.mm.yyyy')
    	then coalesce(datefinal, to_date(param.dEnd, 'dd.mm.yyyy'))
        else to_date(param.dEnd, 'dd.mm.yyyy')
    end) as dateend,
    tktransportrealhistory.finmolcode,
    coalesce(fr.fueltyperefcode,  tktransportrealhistory.fueltypecode) as fueltypecode
     from
     tktransportrealhistory left join entravelsheetfuelremns fr on (fr.realtransportcode = tktransportrealhistory.transportrealrefcode ) ,
      (select $P{dateStart} as dStart, $P{dateFinal} as dEnd ) as param
     where
     tktransportrealhistory.finmolcode =  $P{molcode}
     and (
     		(tktransportrealhistory.datestart >= to_date(param.dStart, 'dd.mm.yyyy')
     		and coalesce(tktransportrealhistory.datefinal,tktransportrealhistory.datestart) <= to_date(param.dEnd, 'dd.mm.yyyy')
     		)
     	or (to_date(param.dStart, 'dd.mm.yyyy') >= tktransportrealhistory.datestart
        	and to_date(param.dStart, 'dd.mm.yyyy') <= coalesce(tktransportrealhistory.datefinal, to_date(param.dEnd, 'dd.mm.yyyy'))
            )
          /*23.05.2012 - не попадали в отчет машины которые передавались с мола на мол в течении отчетного периода (исправлено)*/
        or (
            tktransportrealhistory.datestart between to_date(param.dStart, 'dd.mm.yyyy')  and to_date(param.dEnd, 'dd.mm.yyyy')
           )
        or (
           coalesce(tktransportrealhistory.datefinal, tktransportrealhistory.datestart) between to_date(param.dStart, 'dd.mm.yyyy')  and to_date(param.dEnd, 'dd.mm.yyyy')
            )
         )
     group by tktransportrealhistory.transportrealrefcode, tktransportrealhistory.finmolcode,         coalesce(fr.fueltyperefcode,  tktransportrealhistory.fueltypecode)) as transport_history
     on ( TTT.trcode = transport_history.transportrealrefcode and TTT.ftcode = transport_history.fueltypecode)
) as base_q
) as final_q
where 	(final_q.countgenstart <> 0
	or final_q.countgenfinal <> 0
	or final_q.count_in <> 0
	or final_q.count_out <> 0) and
              (  /*бензин 1 */
          ( final_q.fueltypecode not in (75000003)  and $P{typefuel} = 1 )
           or
           /*дизтопливо */
           (final_q.fueltypecode =  75000003  and $P{typefuel} = 2 )
           )
  group by          final_q.fuelname, final_q.nn_general, final_q.matname_general]]>
	</queryString>
	<field name="fuelname" class="java.lang.String"/>
	<field name="nn_general" class="java.lang.String"/>
	<field name="matname_general" class="java.lang.String"/>
	<field name="sumquantityrash" class="java.math.BigDecimal"/>
	<field name="sumcost" class="java.math.BigDecimal"/>
	<field name="quantity_other" class="java.math.BigDecimal"/>
	<field name="quantity_energosbyt" class="java.math.BigDecimal"/>
	<field name="quantity_kapstr" class="java.math.BigDecimal"/>
	<field name="quantity_rm" class="java.math.BigDecimal"/>
	<field name="quantity_ktrem" class="java.math.BigDecimal"/>
	<field name="quantity_tho" class="java.math.BigDecimal"/>
	<field name="quantity_usl" class="java.math.BigDecimal"/>
	<field name="quantity_dem" class="java.math.BigDecimal"/>
	<field name="fuelgps_globus" class="java.math.BigDecimal"/>
	<field name="count_in" class="java.math.BigDecimal"/>
	<field name="countgenstart" class="java.math.BigDecimal"/>
	<field name="countgenfinal" class="java.math.BigDecimal"/>
	<field name="countgenfinal_sub" class="java.math.BigDecimal"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement x="80" y="0" width="50" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{count_in}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="170" y="0" width="45" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nn_general}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="480" y="0" width="55" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{quantity_rm}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="130" y="0" width="40" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fuelgps_globus}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="245" y="0" width="30" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{sumquantityrash}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="30" y="0" width="50" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{countgenstart}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="425" y="0" width="55" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{quantity_kapstr}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="315" y="0" width="55" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{quantity_other}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="645" y="0" width="55" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{quantity_usl}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="535" y="0" width="55" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{quantity_ktrem}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="370" y="0" width="55" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{quantity_energosbyt}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="805" y="0" width="50" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{countgenfinal_sub}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="590" y="0" width="55" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{quantity_tho}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="700" y="0" width="55" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{quantity_dem}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="755" y="0" width="50" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{countgenfinal}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="0" y="0" width="30" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fuelname}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="215" y="0" width="30" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{matname_general}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="275" y="0" width="40" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="7" isBold="false" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{sumcost}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<lastPageFooter>
		<band height="20" splitType="Stretch">
			<printWhenExpression><![CDATA[new Boolean($V{REPORT_COUNT}.intValue() == 0 )]]></printWhenExpression>
			<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true">
				<reportElement key="textField-30" stretchType="RelativeToTallestObject" x="30" y="0" width="50" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Top">
					<font fontName="Times New Roman" size="6" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true">
				<reportElement key="textField-31" stretchType="RelativeToTallestObject" x="0" y="0" width="30" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" isBold="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.0" isBlankWhenNull="true">
				<reportElement key="textField-32" stretchType="RelativeToTallestObject" x="170" y="0" width="45" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-34" stretchType="RelativeToTallestObject" x="215" y="0" width="30" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-35" stretchType="RelativeToTallestObject" x="370" y="0" width="55" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-37" stretchType="RelativeToTallestObject" x="425" y="0" width="55" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-38" stretchType="RelativeToTallestObject" x="480" y="0" width="55" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-40" stretchType="RelativeToTallestObject" x="535" y="0" width="55" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-41" stretchType="RelativeToTallestObject" x="590" y="0" width="55" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-43" stretchType="RelativeToTallestObject" x="645" y="0" width="55" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-45" stretchType="RelativeToTallestObject" x="700" y="0" width="55" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-47" stretchType="RelativeToTallestObject" x="755" y="0" width="50" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-49" stretchType="RelativeToTallestObject" x="805" y="0" width="50" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.0" isBlankWhenNull="true">
				<reportElement key="textField-56" stretchType="RelativeToTallestObject" x="80" y="0" width="50" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-58" stretchType="RelativeToTallestObject" x="130" y="0" width="40" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-62" stretchType="RelativeToTallestObject" x="245" y="0" width="30" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-63" stretchType="RelativeToTallestObject" x="315" y="0" width="55" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-62" stretchType="RelativeToTallestObject" x="275" y="0" width="40" height="20" isPrintWhenDetailOverflows="true"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Times New Roman" size="7" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
		</band>
	</lastPageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
