<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="sum_by_podr" pageWidth="850" pageHeight="555" orientation="Landscape" columnWidth="850" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="45"/>
	<property name="ireport.y" value="0"/>
	<parameter name="p_countworkhours" class="java.math.BigDecimal"/>
	<parameter name="p_hours_without_otpusk" class="java.math.BigDecimal"/>
	<parameter name="work_pers" class="java.math.BigDecimal"/>
	<parameter name="delivery_all_work" class="java.math.BigDecimal"/>
	<parameter name="work_plan" class="java.math.BigDecimal"/>
	<parameter name="work_not_plan" class="java.math.BigDecimal"/>
	<parameter name="name_itog" class="java.lang.String"/>
	<parameter name="Ppodrkod" class="java.lang.Integer"/>
	<parameter name="pdate2" class="java.lang.String"/>
	<queryString>
		<![CDATA[select 1 as qqq ,
coalesce((select COALESCE(q.coefficient,1) from ENCOEFFICIENTEXECPLAN q
        where q.finpodrcode = $P{Ppodrkod}
        and q.dategen = first_day(to_date($P{pdate2},'dd.mm.yyyy'))
),1) as coefficient]]>
	</queryString>
	<field name="qqq" class="java.lang.Integer"/>
	<field name="coefficient" class="java.math.BigDecimal"/>
	<variable name="var_z_vr" class="java.math.BigDecimal">
		<variableExpression><![CDATA[$P{p_hours_without_otpusk}.doubleValue() > 0 ?
(
	(
	($P{p_hours_without_otpusk}.setScale(2, BigDecimal.ROUND_HALF_UP).multiply(new BigDecimal(0.05))).setScale(2, BigDecimal.ROUND_HALF_UP).
 add($P{delivery_all_work}.setScale(2, BigDecimal.ROUND_HALF_UP)).
 add($P{work_plan}.setScale(2, BigDecimal.ROUND_HALF_UP)).
 add($P{work_not_plan}.setScale(2, BigDecimal.ROUND_HALF_UP))
).setScale(2, BigDecimal.ROUND_HALF_UP).divide($P{p_hours_without_otpusk}.setScale(2, BigDecimal.ROUND_HALF_UP),6, BigDecimal.ROUND_HALF_UP)
).multiply(new BigDecimal(100)).setScale(2, BigDecimal.ROUND_HALF_UP)
: new BigDecimal(0)]]></variableExpression>
	</variable>
	<variable name="var_pb" class="java.math.BigDecimal">
		<variableExpression><![CDATA[$V{var_z_vr}.compareTo(new BigDecimal(100)) == 1 ? new BigDecimal(50) :
(($V{var_z_vr}.compareTo(new BigDecimal(98)) == 1 || $V{var_z_vr}.compareTo(new BigDecimal(98)) == 0) && $V{var_z_vr}.compareTo(new BigDecimal(100)) == -1) ? new BigDecimal(45) :
(($V{var_z_vr}.compareTo(new BigDecimal(96)) == 1 || $V{var_z_vr}.compareTo(new BigDecimal(96)) == 0) && $V{var_z_vr}.compareTo(new BigDecimal(98)) == -1) ? new BigDecimal(35) :
(($V{var_z_vr}.compareTo(new BigDecimal(94)) == 1 || $V{var_z_vr}.compareTo(new BigDecimal(94)) == 0) && $V{var_z_vr}.compareTo(new BigDecimal(96)) == -1) ? new BigDecimal(30) :
(($V{var_z_vr}.compareTo(new BigDecimal(92)) == 1 || $V{var_z_vr}.compareTo(new BigDecimal(92)) == 0) && $V{var_z_vr}.compareTo(new BigDecimal(94)) == -1) ? new BigDecimal(25) :
(($V{var_z_vr}.compareTo(new BigDecimal(90)) == 1 || $V{var_z_vr}.compareTo(new BigDecimal(90)) == 0) && $V{var_z_vr}.compareTo(new BigDecimal(92)) == -1) ? new BigDecimal(20) :
$V{var_z_vr}.compareTo(new BigDecimal(90)) == -1 ? new BigDecimal(0) : new BigDecimal(0)]]></variableExpression>
		<initialValueExpression><![CDATA[new BigDecimal(0)]]></initialValueExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-14" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="310" y="0" width="30" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{p_countworkhours}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true">
				<reportElement key="textField-3" stretchType="RelativeToTallestObject" mode="Transparent" x="0" y="0" width="310" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{name_itog}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-12" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="340" y="0" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{p_hours_without_otpusk}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-20" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="380" y="0" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{work_pers}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-22" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="420" y="0" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{delivery_all_work}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-21" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="500" y="0" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{work_not_plan}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-24" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="460" y="0" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{work_plan}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-44" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="540" y="0" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{work_pers}.
add($P{delivery_all_work}).
add($P{work_plan}).
add($P{work_not_plan})]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-12" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="580" y="0" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{var_z_vr}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-44" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="620" y="0" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{p_hours_without_otpusk}.doubleValue() > 0 ?
($P{work_plan}.divide($P{p_hours_without_otpusk},6, BigDecimal.ROUND_HALF_UP)
).multiply(new BigDecimal(100)).setScale(2, BigDecimal.ROUND_HALF_UP)
: new BigDecimal(0)]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-44" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="660" y="0" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{p_hours_without_otpusk}.doubleValue() > 0 ?
($P{work_not_plan}.divide($P{p_hours_without_otpusk},6, BigDecimal.ROUND_HALF_UP)
).multiply(new BigDecimal(100)).setScale(2, BigDecimal.ROUND_HALF_UP)
: new BigDecimal(0)]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-7" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="740" y="0" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{coefficient}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-7" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="780" y="0" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{var_pb}.multiply($F{coefficient}).setScale(0, BigDecimal.ROUND_HALF_UP)]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
				<reportElement key="textField-7" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="700" y="0" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{var_pb}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
