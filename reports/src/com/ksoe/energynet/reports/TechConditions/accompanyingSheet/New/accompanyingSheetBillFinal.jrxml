<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="accompanyingSheetBillFinal" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="505" leftMargin="72" rightMargin="18" topMargin="10" bottomMargin="72" scriptletClass="com.ksoe.energynet.reports.common.FINScriptlet">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="1.1"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="sheetCode" class="java.lang.Integer"/>
	<queryString>
		<![CDATA[select
  so.contragentname, so.contragentaddress,
  so.contractnumberservices||'/'||so.contractnumber as contractnumber,
  to_char(so.contractdate,'dd.MM.yyyy') as contractdate,
  case when tco.numbergen like '%EWF%'
    then '_____________'
    else tco.numbergen
  end as tynumber,
  case when tco.numbergen like '%EWF%'
    then '"___" ___________ 20___'
    else to_char(tco.dategen,'dd.MM.yyyy') end as tydate,
  tco.building,
  tco.address,
  ( COALESCE((select ensovalues.strval from ensovalues
     where ensovalues.servicesobjectcode = so.code
     and ensovalues.sovaluestypecode = 10), '')
  ) as strval,

  s.numbergen, s.dategen,
  s.dfdocnumber, s.dfdocdate,
  coalesce(s.executorfio, '') as executorfio,
  coalesce(s.executorphone, '') as executorphone,
  coalesce(s.executoremail, '') as executoremail,
  s.signerfio, s.signerposition,
  s.recipient, s.recipientaddress,
  coalesce(s.additionaltext, '') as additionaltext,
  s.iswithsignature, sg.signatureimagepath
from
  ensheets4so s,
  ensheets4sotype st left join ensigner sg on st.signerrefcode = sg.code,
  enservicesobject so,
  entechconditionsobjcts tco
where s.sheet4sotypecode = st.code
  and s.servicesobjectcode = so.code
  and so.techconobjectscode = tco.code
  and s.code = $P{sheetCode}]]>
	</queryString>
	<field name="contragentname" class="java.lang.String"/>
	<field name="contragentaddress" class="java.lang.String"/>
	<field name="contractnumber" class="java.lang.String"/>
	<field name="contractdate" class="java.lang.String"/>
	<field name="tynumber" class="java.lang.String"/>
	<field name="tydate" class="java.lang.String"/>
	<field name="building" class="java.lang.String"/>
	<field name="address" class="java.lang.String"/>
	<field name="strval" class="java.lang.String"/>
	<field name="numbergen" class="java.lang.String"/>
	<field name="dategen" class="java.sql.Date"/>
	<field name="dfdocnumber" class="java.lang.String"/>
	<field name="dfdocdate" class="java.sql.Date"/>
	<field name="executorfio" class="java.lang.String"/>
	<field name="executorphone" class="java.lang.String"/>
	<field name="executoremail" class="java.lang.String"/>
	<field name="signerfio" class="java.lang.String"/>
	<field name="signerposition" class="java.lang.String"/>
	<field name="recipient" class="java.lang.String"/>
	<field name="recipientaddress" class="java.lang.String"/>
	<field name="additionaltext" class="java.lang.String"/>
	<field name="iswithsignature" class="java.lang.Integer"/>
	<field name="signatureimagepath" class="java.lang.String"/>
	<variable name="companyShortName" class="java.lang.String">
		<variableExpression><![CDATA[$V{companyShortName}]]></variableExpression>
		<initialValueExpression><![CDATA[((com.ksoe.energynet.reports.common.FINScriptlet)$P{REPORT_SCRIPTLET}).getSettings("company.shortname")]]></initialValueExpression>
	</variable>
	<variable name="dateFormat" class="java.text.SimpleDateFormat">
		<variableExpression><![CDATA[$V{dateFormat}]]></variableExpression>
		<initialValueExpression><![CDATA[new SimpleDateFormat("dd.MM.yyyy")]]></initialValueExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="110" splitType="Prevent">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-31" positionType="Float" isPrintRepeatedValues="false" mode="Transparent" x="190" y="70" width="318" height="15" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None">
					<font fontName="Times New Roman" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="timesbd.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{recipient}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-31" positionType="Float" isPrintRepeatedValues="false" mode="Transparent" x="190" y="85" width="315" height="15" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None">
					<font fontName="Times New Roman" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="timesbd.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{recipientaddress}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-31" positionType="Float" isPrintRepeatedValues="false" mode="Transparent" x="0" y="40" width="254" height="30" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="timesbd.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["№ " + $F{dfdocnumber} + " від " + $V{dateFormat}.format($F{dfdocdate}) + "р."]]></textFieldExpression>
			</textField>
			<subreport>
				<reportElement x="0" y="0" width="505" height="40" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true"/>
				<subreportExpression><![CDATA[getClass().getResourceAsStream("/com/ksoe/energynet/reports/TechConditions/accompanyingSheet/New/accompanyingSheetHeader_sub.jasper")]]></subreportExpression>
			</subreport>
		</band>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="126" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-31" positionType="Float" isPrintRepeatedValues="false" mode="Transparent" x="0" y="0" width="505" height="33" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None">
					<font fontName="Times New Roman" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="timesbd.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[" Супровідний лист до рахунку для\n" +
" здійснення остаточної плати за приєднання"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-32" positionType="Float" isPrintRepeatedValues="false" mode="Transparent" x="0" y="33" width="505" height="10" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Justified" verticalAlignment="Top" rotation="None">
					<font fontName="Times New Roman" size="13" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["      " + $V{companyShortName} + " повідомляє Вас про завершення етапів розробки проєктної документації щодо електричних мереж зовнішнього електрозабезпечення Вашого об'єкта (" + $F{building} + ", " + $F{address} + ") та узгодження її з усіма заінтересованими сторонами.\n" +
"      " + "Тому, для виконання робіт з приєднання направляємо Вам остаточний розрахунок у розмірі 80 відсотків плати, визначеної пунктом 4.1 Договору № " + $F{contractnumber} + " від " + $F{contractdate} + "р. про стандартне приєднання до електричних мереж системи розподілу.\n" +
"      " + "Додатково повідомляємо, що термін надання послуги з приєднання призупиняється до моменту здійснення Вами остаточної оплати вартості послуги з приєднання до електричних мереж.\n\n\n" +
"      " + "Додаток:  Остаточний розрахунок у розмірі 80 відсотків повної вартості приєднання — 1 примірник.\n" +
($F{additionaltext} != null ? $F{additionaltext} : "")]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-31" positionType="Float" isPrintRepeatedValues="false" mode="Transparent" x="0" y="102" width="269" height="11" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="8" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="timesbd.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{executorfio}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-31" positionType="Float" isPrintRepeatedValues="false" mode="Transparent" x="326" y="60" width="179" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Bottom" rotation="None">
					<font fontName="Times New Roman" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="timesbd.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{signerfio}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-31" positionType="Float" isPrintRepeatedValues="false" mode="Transparent" x="326" y="43" width="179" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom" rotation="None">
					<font fontName="Times New Roman" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="timesbd.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
			</textField>
			<image scaleImage="RetainShape" hAlign="Center">
				<reportElement positionType="Float" x="190" y="43" width="136" height="83">
					<printWhenExpression><![CDATA[$F{iswithsignature} == 1]]></printWhenExpression>
				</reportElement>
				<imageExpression><![CDATA[getClass().getResourceAsStream($F{signatureimagepath})]]></imageExpression>
			</image>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-31" positionType="Float" isPrintRepeatedValues="false" mode="Transparent" x="0" y="43" width="190" height="34" isRemoveLineWhenBlank="true" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Bottom" rotation="None">
					<font fontName="Times New Roman" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="timesbd.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["\n"+$F{signerposition}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-31" positionType="Float" isPrintRepeatedValues="false" mode="Transparent" x="0" y="113" width="269" height="11" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="8" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="timesbd.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{executorphone}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Prevent"/>
	</pageFooter>
	<lastPageFooter>
		<band splitType="Prevent"/>
	</lastPageFooter>
	<summary>
		<band splitType="Prevent"/>
	</summary>
</jasperReport>
