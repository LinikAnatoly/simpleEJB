<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ActPriPer" pageWidth="510" pageHeight="842" columnWidth="490" leftMargin="10" rightMargin="10" topMargin="0" bottomMargin="0" scriptletClass="com.ksoe.energynet.reports.common.FINScriptlet" isIgnorePagination="true">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="ContractCode" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new Integer(0)]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select
    coalesce(so.contractnumber,'') as contractnumber,
    coalesce(wa.numbergen,' ') as numbergen,
    so.contractdate,
    coalesce(to_char(so.contractdate, 'dd'),'') as daygen,
    coalesce(to_char(so.contractdate, 'mm'),'') as monthgen,
    (select
    	case cast(to_char(so.contractdate, 'mm') as numeric)
        	when 1
            then 'січня'
            when 2
            then 'лютого'
            when 3
            then 'березня'
            when 4
            then 'квітня'
            when 5
            then 'травня'
            when 6
            then 'червня'
            when 7
            then 'липня'
            when 8
            then 'серпня'
            when 9
            then 'вересня'
            when 10
            then 'жовтня'
            when 11
            then 'листопада'
            when 12
            then 'грудня'
            else 'невідомо'

        end) as txt_monthgen,
    (select
    	'"'||to_char(so.contractdate, 'dd')||'"'||' '||
        (case cast(to_char(so.contractdate, 'mm') as numeric)
        	when 1
            then 'січня'
            when 2
            then 'лютого'
            when 3
            then 'березня'
            when 4
            then 'квітня'
            when 5
            then 'травня'
            when 6
            then 'червня'
            when 7
            then 'липня'
            when 8
            then 'серпня'
            when 9
            then 'вересня'
            when 10
            then 'жовтня'
            when 11
            then 'листопада'
            when 12
            then 'грудня'
            else 'невідомо'
        end)||' '||to_char(so.contractdate, 'yyyy')
    ) as txt_date_vid,
    coalesce(to_char(so.contractdate, 'yyyy'),'') as yeargen,
    coalesce(de.name,'') as depname,
    coalesce(ep.rencity,'') as rencity,
    coalesce((wa.warrantposition),'НЕВСТАНОВЛЕНЕ') as position_nach,
    coalesce(wa.warrantfio,'НЕВСТАНОВЛЕНЕ') as fio_nach,
    coalesce(so.contragentname,'НЕВСТАНОВЛЕНЕ') as contragentname,
   cast(coalesce(cct.totalcost,0) as numeric(10,2)) as summa,
    textgrivna(coalesce(cct.totalcost::numeric(15,2),0)) as txt_summa,
   cast(coalesce(cct.costvat,0) as numeric(10,2)) as nds,
    textgrivna(coalesce(cct.costvat::numeric(15,2),0)) as txt_nds,
    coalesce(so.contragentbossname, coalesce(so.warrantfio , 'НЕВСТАНОВЛЕНЕ' )) as contragentboss
from
	(enservicesobject as so
    left join
    enwarrant as wa
    on
    so.warrantrefcode = wa.code
    )
    left join
    (endepartment as de
    inner join
    (endepartment as de1
    inner join
    (endepartment2epren as deep
    inner join
    epren as ep
    on
    deep.renrefcode = ep.code)
    on
    de1.code = deep.departmentrefcode)
    on
    de1.code = de.rencode)
    on
    so.departmentcode = de.code
    , enplanwork pw ,  encalccontracttotal cct
where
	so.code = $P{ContractCode}
    and so.elementcode = pw.elementrefcode
    and cct.planrefcode = pw.code
    and pw.kindcode = 5]]>
	</queryString>
	<field name="contractnumber" class="java.lang.String"/>
	<field name="numbergen" class="java.lang.String"/>
	<field name="contractdate" class="java.sql.Date"/>
	<field name="daygen" class="java.lang.String"/>
	<field name="monthgen" class="java.lang.String"/>
	<field name="txt_monthgen" class="java.lang.String"/>
	<field name="txt_date_vid" class="java.lang.String"/>
	<field name="yeargen" class="java.lang.String"/>
	<field name="depname" class="java.lang.String"/>
	<field name="rencity" class="java.lang.String"/>
	<field name="position_nach" class="java.lang.String"/>
	<field name="fio_nach" class="java.lang.String"/>
	<field name="contragentname" class="java.lang.String"/>
	<field name="summa" class="java.math.BigDecimal"/>
	<field name="txt_summa" class="java.lang.String"/>
	<field name="nds" class="java.math.BigDecimal"/>
	<field name="txt_nds" class="java.lang.String"/>
	<field name="contragentboss" class="java.lang.String"/>
	<variable name="companyShortName" class="java.lang.String">
		<variableExpression><![CDATA[$V{companyShortName}]]></variableExpression>
		<initialValueExpression><![CDATA[((com.ksoe.energynet.reports.common.FINScriptlet)$P{REPORT_SCRIPTLET}).getSettings("company.shortname")]]></initialValueExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="49" splitType="Stretch">
			<textField isStretchWithOverflow="true" evaluationTime="Report" isBlankWhenNull="true">
				<reportElement key="textField-3" positionType="Float" mode="Transparent" x="1" y="0" width="488" height="33" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Bottom" rotation="None">
					<font fontName="Times New Roman" size="14" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["Акт"+"\n"+
" прийому передачі виконаних робіт"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-4" stretchType="RelativeToBandHeight" mode="Transparent" x="0" y="33" width="142" height="16" isPrintWhenDetailOverflows="true" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None">
					<font fontName="Times New Roman" size="14" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{rencity}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-6" stretchType="RelativeToBandHeight" mode="Transparent" x="196" y="33" width="142" height="16" isPrintWhenDetailOverflows="true" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None">
					<font fontName="Times New Roman" size="14" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["№ "+$F{contractnumber}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="325" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-5" positionType="Float" stretchType="RelativeToTallestObject" mode="Transparent" x="0" y="19" width="489" height="300" isPrintWhenDetailOverflows="true" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None">
					<font fontName="Times New Roman" size="14" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{depname} + "   " + $V{companyShortName} + " в особі "+$F{position_nach}+", що діє на "+
" підставі Доручення № "+$F{numbergen}+" (надалі - Виконавець) та "+$F{contragentname}+" (надалі - Замовник),"+
" склали цей Акт про наступне."+"\n"+
"   Виконавець виконав, а Замовник прийняв роботи, виконані у відповідності з Договором "+
"№ "+$F{contractnumber}+" на виконання робіт від " +$F{txt_date_vid} +" року."+"\n"+
"   Загальна вартість виконаних робіт складає "+$F{summa}+" грн. ("+$F{txt_summa}+")"+" в тому числі ПДВ "+$F{nds}+" ("+$F{txt_nds}+")"+"\n"+
"   Замовник не має ніяких претензій щодо якості та повноти виконаних робіт." + "\n"+
"   Акт складено та підписано у трьох примірниках, по одному для кожної із Сторін, кожен екземпляр "+
" має однакову юридичну силу."]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="197" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-10" stretchType="RelativeToTallestObject" mode="Transparent" x="0" y="0" width="226" height="16" isPrintWhenDetailOverflows="true" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Bottom" rotation="None">
					<font fontName="Times New Roman" size="10" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["Виконавець"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-11" stretchType="RelativeToTallestObject" mode="Transparent" x="243" y="0" width="247" height="16" isPrintWhenDetailOverflows="true" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Bottom" rotation="None">
					<font fontName="Times New Roman" size="10" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["Замовник"]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="textField-14" positionType="Float" stretchType="RelativeToTallestObject" x="2" y="140" width="97" height="16"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Top" rotation="None">
					<font fontName="Times New Roman" size="9" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["(підпис)"]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="textField-15" positionType="Float" stretchType="RelativeToTallestObject" x="243" y="140" width="120" height="16"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None">
					<font fontName="Times New Roman" size="9" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["(підпис)"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-16" stretchType="RelativeToTallestObject" mode="Transparent" x="0" y="16" width="226" height="80" isPrintWhenDetailOverflows="true" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Bottom" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{position_nach}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-17" stretchType="RelativeToTallestObject" mode="Transparent" x="243" y="16" width="112" height="109" isPrintWhenDetailOverflows="true" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Bottom" rotation="None">
					<font fontName="Times New Roman" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["_______________"]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="textField-18" positionType="Float" x="120" y="140" width="47" height="16"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None">
					<font fontName="Times New Roman" size="9" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["М.П."]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField-19" stretchType="RelativeToBandHeight" mode="Transparent" x="355" y="16" width="117" height="109" isPrintWhenDetailOverflows="true" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Bottom" rotation="None">
					<font fontName="Times New Roman" size="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{contragentboss}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="textField-20" positionType="Float" stretchType="RelativeToTallestObject" x="100" y="96" width="126" height="30"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom" rotation="None">
					<font fontName="Times New Roman" size="9" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fio_nach}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="textField-21" positionType="Float" stretchType="RelativeToTallestObject" x="0" y="96" width="100" height="30"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Bottom" rotation="None">
					<font fontName="Times New Roman" size="9" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["___________ "]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
