<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ConnectionFactCost" pageWidth="5000" pageHeight="900" orientation="Landscape" whenNoDataType="NoDataSection" columnWidth="4940" leftMargin="30" rightMargin="30" topMargin="20" bottomMargin="20" scriptletClass="com.ksoe.energynet.reports.common.FINScriptlet" isIgnorePagination="true">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="385"/>
	<property name="ireport.y" value="0"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="dateStart" class="java.util.Date">
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="dateFinal" class="java.util.Date">
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="isWithoutCapitalCosts" class="java.lang.Integer">
		<parameterDescription><![CDATA[Не включать договора без актов капитальных затрат (1 - да, 0 - нет)]]></parameterDescription>
		<defaultValueExpression><![CDATA[new BigDecimal(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="isWithoutZeroPayment" class="java.lang.Integer">
		<parameterDescription><![CDATA[Не включать без оплаты (1 - да, 0 - нет)]]></parameterDescription>
		<defaultValueExpression><![CDATA[new BigDecimal(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="isCityVillage" class="java.lang.Integer">
		<parameterDescription><![CDATA[Признак необходимо ли выбирать договора с признаком село или город
значения:
0 - все договора
1 - город
2 - село]]></parameterDescription>
	</parameter>
	<parameter name="isStandardNonStandard" class="java.lang.Integer">
		<parameterDescription><![CDATA[Признак необходимо ли выбирать договора с определнном типом присоединения
значения:
0 - все договора
1 - стандартное
2 - нестандартное]]></parameterDescription>
	</parameter>
	<parameter name="tcsCode" class="java.lang.String"/>
	<parameter name="po_date_provodki" class="java.lang.Integer"/>
	<queryString>
		<![CDATA[SELECT
enplanworkstate_ps_35_110_150 ,enplanworkstate_ps_10_6_04 ,
case when 2 in  (select array2items(string_to_array(( enplanworkstate_pl_35_150::varchar ),','))::double precision)
            	      and 3 in (select array2items(string_to_array(( enplanworkstate_pl_35_150::varchar ),','))::double precision)
            	then 'Реконструкція ПЛ,' ||to_char( quantity_pl_35_150_rm, 'FM99999990.999') || 'км'  || ' ; Будівництво ПЛ, ' || to_char( quantity_pl_35_150_kb, 'FM99999990.999') || 'км'
     when 2 in (select array2items(string_to_array(( enplanworkstate_pl_35_150::varchar ),','))::double precision)
      and 3 not in (select array2items(string_to_array(( enplanworkstate_pl_35_150::varchar ),','))::double precision)
then 'Реконструкція ПЛ, ' || to_char( quantity_pl_35_150_rm, 'FM99999990.999') || 'км'
     when 2 not in (select array2items(string_to_array(( enplanworkstate_pl_35_150::varchar ),','))::double precision)
      and 3 in (select array2items(string_to_array(( enplanworkstate_pl_35_150::varchar ),','))::double precision)
			then 'Будівництво ПЛ, '|| to_char(quantity_pl_35_150_kb, 'FM99999990.999') || 'км'
			else ' ' end as enplanworkstate_pl_35_150 ,
quantity_pl_35_150_rm ,
quantity_pl_35_150_kb ,
case when 2 in  (select array2items(string_to_array(( enplanworkstate_pl_10_6::varchar ),','))::double precision)
            	      and 3 in (select array2items(string_to_array(( enplanworkstate_pl_10_6::varchar ),','))::double precision)
            	then 'Реконструкція ПЛ,' || to_char(quantity_pl_10_6_rm, 'FM99999990.999') || 'км'  || ' ; Будівництво ПЛ, ' || to_char(quantity_pl_10_6_kb, 'FM99999990.999') || 'км'
     when 2 in (select array2items(string_to_array(( enplanworkstate_pl_10_6::varchar ),','))::double precision)
      and 3 not in (select array2items(string_to_array(( enplanworkstate_pl_10_6::varchar ),','))::double precision)
then 'Реконструкція ПЛ, '|| to_char(quantity_pl_10_6_rm, 'FM99999990.999') || 'км'
     when 2 not in (select array2items(string_to_array(( enplanworkstate_pl_10_6::varchar ),','))::double precision)
      and 3 in (select array2items(string_to_array(( enplanworkstate_pl_10_6::varchar ),','))::double precision)
		then 'Будівництво ПЛ, '|| to_char(quantity_pl_10_6_kb, 'FM99999990.999') || 'км'
		else ' ' end as enplanworkstate_pl_10_6 ,
quantity_pl_10_6_rm ,
quantity_pl_10_6_kb ,
case when 2 in  (select array2items(string_to_array(( enplanworkstate_pl_kl_04::varchar ),','))::double precision)
            	      and 3 in (select array2items(string_to_array(( enplanworkstate_pl_kl_04::varchar ),','))::double precision)
            	then 'Реконструкція ПЛ,' || to_char( quantity_pl_kl_04_rm, 'FM99999990.999') || 'км'  || ' ; Будівництво ПЛ, ' || to_char( quantity_pl_kl_04_kb, 'FM99999990.999') || 'км'
     when 2 in (select array2items(string_to_array(( enplanworkstate_pl_kl_04::varchar ),','))::double precision)
      and 3 not in (select array2items(string_to_array(( enplanworkstate_pl_kl_04::varchar ),','))::double precision)
then 'Реконструкція ПЛ, '|| to_char(quantity_pl_kl_04_rm, 'FM99999990.999') || 'км'
     when 2 not in (select array2items(string_to_array(( enplanworkstate_pl_kl_04::varchar ),','))::double precision)
      and 3 in (select array2items(string_to_array(( enplanworkstate_pl_kl_04::varchar ),','))::double precision)
		then 'Будівництво ПЛ, '|| to_char(quantity_pl_kl_04_kb, 'FM99999990.999') || 'км'
		else ' ' end as enplanworkstate_pl_kl_04 ,
quantity_pl_kl_04_rm ,
quantity_pl_kl_04_kb ,
entechconditionsservcscode ,
kki   ,kni   ,kfi  ,kzti_nonstandard ,connectionkindrefcode ,kmisci_nonstandard ,ksvi_nonstandard ,resultstandardkoef ,resultnonstandardkoef ,stavka                                                                         ,buhstatusname ,contractnumber                                                  ,partnername                                                                             ,address                                               ,regiontype ,trustfulnesscategory ,voltagedegree ,phasity             ,power ,tycurrentpower ,sum_payed ,sum_calculated ,int_regionaltype ,capital ,costs ,unmount ,connectionpowerplaces                                                                           ,connectionpowerpoint ,profit ,profit_formula           ,cnpackcode ,cnsubsystemtyperefcode ,personalaccountnumber ,countline04 ,countline10 ,countline35 ,countline150 ,counttp04 ,counttp35 ,counttp110 ,counttp150 ,contragenttype ,depname              ,sum_project ,sum_capital_tp_110_150 ,sum_capital_tp_20_10 ,sum_capital_line_110_150 ,sum_capital_line_10 ,sum_capital_line_04 ,dateprov ,voltageservices ,nodes_plainlist_normal_s150    ,nodes_plainlist_normal_s35 ,maxdateact
from(

select
   distinct
   ( /*Необхідність будівництва / реконструкції підстанції напругою U, кв. (з переліком відповідних робіт: заміна трансформатора, вимикача, розподільчого пристрою тощо) за ступенями напруги
   110(150)/35/10(6)	"110(150)  /10(6)"	35/10(6) */

        	(select
            	case when 2 in (select array2items(string_to_array(( enplanworkstate::varchar ),','))::double precision)
            	      and 3 in (select array2items(string_to_array(( enplanworkstate::varchar ),','))::double precision)
            	then 'Реконструкція ПС, 1 шт ; Будівництво ПС, 1 шт'
            	     when 2 in (select array2items(string_to_array(( enplanworkstate::varchar ),','))::double precision)
            	      and 3 not in (select array2items(string_to_array(( enplanworkstate::varchar ),','))::double precision)
            	then 'Реконструкція ПС, 1 шт '
            	     when 2 not in (select array2items(string_to_array(( enplanworkstate::varchar ),','))::double precision)
            	      and 3 in (select array2items(string_to_array(( enplanworkstate::varchar ),','))::double precision)
            	then 'Будівництво ПС, 1 шт'
            	else ' ' end as enplanworkstate_ps_35_110_150


            from (
            	select distinct
    				ac1.acttyperefcode as enplanworkstate
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
				where
					tcpw1.techconservicesrefcode = entechconditionsservcscode
					and ac1.acttyperefcode in ( 2/*РМ*/, 4/*КБ*/  )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in (   6, /*Подстанция 35-150 кВ*/
											  26 /*Об`єкти групи обліку на ПС 150-35-10*/
                                             )

                    union
                    select distinct pw1.staterefcode as enplanworkstate from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
					where tcpw1.techconservicesrefcode = entechconditionsservcscode
                      and pw1.staterefcode in (2/*РМ*/, 4/*КБ*/)
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 6, /*Подстанция 35-150 кВ*/
											  26 /*Об`єкти групи обліку на ПС 150-35-10*/
                                             )


        )as q1 limit 1 ) )
 as enplanworkstate_ps_35_110_150 ,
 ( /*Необхідність будівництва / реконструкції підстанції напругою U, кв. (з переліком відповідних робіт: заміна трансформатора, вимикача, розподільчого пристрою тощо) за ступенями напруги
  10(6)/0.4*/

        	(select
            	case when 2 in (select array2items(string_to_array(( enplanworkstate::varchar ),','))::double precision)
            	      and 3 in (select array2items(string_to_array(( enplanworkstate::varchar ),','))::double precision)
            	then 'Реконструкція ПС, 1 шт , Будівництво ПС, 1 шт'
            	     when 2 in (select array2items(string_to_array(( enplanworkstate::varchar ),','))::double precision)
            	      and 3 not in (select array2items(string_to_array(( enplanworkstate::varchar ),','))::double precision)
            	then 'Реконструкція ПС, 1 шт '
            	     when 2 not in (select array2items(string_to_array(( enplanworkstate::varchar ),','))::double precision)
            	      and 3 in (select array2items(string_to_array(( enplanworkstate::varchar ),','))::double precision)
            	then 'Будівництво ПС, 1 шт'
            	else ' ' end as enplanworkstate_ps_10_6_04


            from (
            	select distinct
    				ac1.acttyperefcode as enplanworkstate
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
				where
					tcpw1.techconservicesrefcode = entechconditionsservcscode
					and ac1.acttyperefcode in ( 2/*РМ*/, 4/*КБ*/  )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in ( 3	/*ТП 0.4 кВ*/ )

                    union
                    select distinct pw1.staterefcode as enplanworkstate from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
					where tcpw1.techconservicesrefcode = entechconditionsservcscode
                      and pw1.staterefcode in (2/*РМ*/, 4/*КБ*/)
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 3	/*ТП 0.4 кВ*/ )


        )as q1 limit 1 ) )
 as enplanworkstate_ps_10_6_04 ,
 /*pl*/
 ( /*Необхідність будівництва / реконструкції лінії електропередачі у км напругою U, кВ (із зазначенням типу ліній електропередачі: повітряна лінія або кабельна лінія) за ступенями
  110(150)	35	10(6) */

        	(select
            	string_agg( enplanworkstate::varchar ,',')  as  enplanworkstate_pl_35_150

            from (
            	select distinct ac1.acttyperefcode as enplanworkstate
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
				where
					tcpw1.techconservicesrefcode = entechconditionsservcscode
					and ac1.acttyperefcode in ( 2/*РМ*/, 4/*КБ*/  )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in ( 5 /*Повітряна лінія 35-150 кВ*/)

                    union all
                    select distinct pw1.staterefcode as enplanworkstate from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
					where tcpw1.techconservicesrefcode = entechconditionsservcscode
                      and pw1.staterefcode in (2/*РМ*/, 4/*КБ*/)
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 5 /*Повітряна лінія 35-150 кВ*/)


        )as q1 ) )
 as enplanworkstate_pl_35_150 ,

 ( /*Необхідність будівництва / реконструкції лінії електропередачі у км напругою U, кВ (із зазначенням типу ліній електропередачі: повітряна лінія або кабельна лінія) за ступенями
  110(150)	35	10(6) RM */

        	(select
            	sum(coalesce(quantity_pl_35_150_RM)) as quantity_pl_35_150_RM

            from (
            	select coalesce(fm.quantity ,0) as quantity_pl_35_150_RM
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
					inner join enplanwork pp on  (acpw1.plancode = pp.code and pp.kindcode=4 )
					inner join enestimateitem ii on pp.code=ii.planrefcode and ii.kindrefcode = 1
					inner join finmaterials fm on ii.code = fm.estimateitemrefcode and fm.statusrefcode = 1 and fm.cost<> 0
					inner join tkmaterials mm on ii.materialrefcode = mm.code and mm.measurementcode = 8/*КМ*/
				where
					tcpw1.techconservicesrefcode = entechconditionsservcscode
					and ac1.acttyperefcode in ( 2/*РМ*/  )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in ( 5 /*Повітряна лінія 35-150 кВ*/)

                    union all
                    select coalesce(fm.quantity ,0) as quantity_pl_35_150_RM from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
                    inner join enplanwork pp on  (pw1.code = pp.code and pp.kindcode=4 )
					inner join enestimateitem ii on pp.code=ii.planrefcode and ii.kindrefcode = 1
					inner join finmaterials fm on ii.code = fm.estimateitemrefcode and fm.statusrefcode = 1
					inner join tkmaterials mm on ii.materialrefcode = mm.code and mm.measurementcode = 8/*КМ*/
					where tcpw1.techconservicesrefcode = entechconditionsservcscode
                      and pw1.staterefcode in (2/*РМ*/ )
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 5 /*Повітряна лінія 35-150 кВ*/)


        )as q1 ) )
 as quantity_pl_35_150_RM ,

 ( /*Необхідність будівництва / реконструкції лінії електропередачі у км напругою U, кВ (із зазначенням типу ліній електропередачі: повітряна лінія або кабельна лінія) за ступенями
  110(150)	35	10(6) KB */

        	(select
            	sum(coalesce(quantity_pl_35_150_KB)) as quantity_pl_35_150_KB

            from (
            	select coalesce(fm.quantity ,0) as quantity_pl_35_150_KB
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
					inner join enplanwork pp on  (acpw1.plancode = pp.code and pp.kindcode=4 )
					inner join enestimateitem ii on pp.code=ii.planrefcode and ii.kindrefcode = 1
					inner join finmaterials fm on ii.code = fm.estimateitemrefcode and fm.statusrefcode = 1 and fm.cost<> 0
					inner join tkmaterials mm on ii.materialrefcode = mm.code and mm.measurementcode = 8/*КМ*/
				where
					tcpw1.techconservicesrefcode = entechconditionsservcscode
					and ac1.acttyperefcode in (4/*КБ*/ )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in ( 5 /*Повітряна лінія 35-150 кВ*/)

                    union all
                    select coalesce(fm.quantity ,0) as quantity_pl_35_150_KB from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
                    inner join enplanwork pp on  (pw1.code = pp.code and pp.kindcode=4 )
					inner join enestimateitem ii on pp.code=ii.planrefcode and ii.kindrefcode = 1
					inner join finmaterials fm on ii.code = fm.estimateitemrefcode and fm.statusrefcode = 1
					inner join tkmaterials mm on ii.materialrefcode = mm.code and mm.measurementcode = 8/*КМ*/
					where tcpw1.techconservicesrefcode = entechconditionsservcscode
                      and pw1.staterefcode in (4/*КБ*/  )
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 5 /*Повітряна лінія 35-150 кВ*/)


        )as q1 ) )
 as quantity_pl_35_150_KB ,

 ( /*Необхідність будівництва / реконструкції лінії електропередачі у км напругою U, кВ (із зазначенням типу ліній електропередачі: повітряна лінія або кабельна лінія) за ступенями  10 6 */

        	(select
            	string_agg( enplanworkstate::varchar ,',') as enplanworkstate_pl_10_6

            from (
            	select distinct
    				ac1.acttyperefcode as enplanworkstate
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
				where
					tcpw1.techconservicesrefcode = entechconditionsservcscode
					and ac1.acttyperefcode in ( 2/*РМ*/, 4/*КБ*/  )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in ( 1	/*Повітряна лінія 6-10 кВ*/)

                    union all
                    select distinct pw1.staterefcode as enplanworkstate from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
					where tcpw1.techconservicesrefcode = entechconditionsservcscode
                      and pw1.staterefcode in (2/*РМ*/, 4/*КБ*/)
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 1	/*Повітряна лінія 6-10 кВ*/)


        )as q1 ) )
 as enplanworkstate_pl_10_6  ,

 ( /*Необхідність будівництва / реконструкції лінії електропередачі у км напругою U, кВ (із зазначенням типу ліній електропередачі: повітряна лінія або кабельна лінія) за ступенями
  10_6 RM */

        	(select
            	sum(coalesce(quantity_pl_10_6_RM)) as quantity_pl_10_6_RM

            from (
            	select coalesce(fm.quantity ,0) as quantity_pl_10_6_RM
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
					inner join enplanwork pp on  (acpw1.plancode = pp.code and pp.kindcode=4 )
					inner join enestimateitem ii on pp.code=ii.planrefcode and ii.kindrefcode = 1
					inner join finmaterials fm on ii.code = fm.estimateitemrefcode and fm.statusrefcode = 1 and fm.cost<> 0
					inner join tkmaterials mm on ii.materialrefcode = mm.code and mm.measurementcode = 8/*КМ*/
				where
					tcpw1.techconservicesrefcode = entechconditionsservcscode
					and ac1.acttyperefcode in ( 2/*РМ*/  )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in ( 1	/*Повітряна лінія 6-10 кВ*/)

                    union all
                    select coalesce(fm.quantity ,0) as quantity_pl_10_6_RM from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
                    inner join enplanwork pp on  (pw1.code = pp.code and pp.kindcode=4 )
					inner join enestimateitem ii on pp.code=ii.planrefcode and ii.kindrefcode = 1
					inner join finmaterials fm on ii.code = fm.estimateitemrefcode and fm.statusrefcode = 1
					inner join tkmaterials mm on ii.materialrefcode = mm.code and mm.measurementcode = 8/*КМ*/
					where tcpw1.techconservicesrefcode = entechconditionsservcscode
                      and pw1.staterefcode in (2/*РМ*/ )
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 1	/*Повітряна лінія 6-10 кВ*/)


        )as q1 ) )
 as quantity_pl_10_6_RM ,

 ( /*Необхідність будівництва / реконструкції лінії електропередачі у км напругою U, кВ (із зазначенням типу ліній електропередачі: повітряна лінія або кабельна лінія) за ступенями
  110(150)	35	10(6) KB */

        	(select
            	sum(coalesce(quantity_pl_10_6_KB)) as quantity_pl_10_6_KB

            from (
            	select coalesce(fm.quantity ,0) as quantity_pl_10_6_KB
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
					inner join enplanwork pp on  (acpw1.plancode = pp.code and pp.kindcode=4 )
					inner join enestimateitem ii on pp.code=ii.planrefcode and ii.kindrefcode = 1
					inner join finmaterials fm on ii.code = fm.estimateitemrefcode and fm.statusrefcode = 1 and fm.cost<> 0
					inner join tkmaterials mm on ii.materialrefcode = mm.code and mm.measurementcode = 8/*КМ*/
				where
					tcpw1.techconservicesrefcode = entechconditionsservcscode
					and ac1.acttyperefcode in (4/*КБ*/ )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in ( 1	/*Повітряна лінія 6-10 кВ*/)

                    union all
                    select coalesce(fm.quantity ,0) as quantity_pl_10_6_KB from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
                    inner join enplanwork pp on  (pw1.code = pp.code and pp.kindcode=4 )
					inner join enestimateitem ii on pp.code=ii.planrefcode and ii.kindrefcode = 1
					inner join finmaterials fm on ii.code = fm.estimateitemrefcode and fm.statusrefcode = 1
					inner join tkmaterials mm on ii.materialrefcode = mm.code and mm.measurementcode = 8/*КМ*/
					where tcpw1.techconservicesrefcode = entechconditionsservcscode
                      and pw1.staterefcode in (4/*КБ*/  )
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 1	/*Повітряна лінія 6-10 кВ*/)


        )as q1 ) )
 as quantity_pl_10_6_KB ,



 ( /*Необхідність будівництва / реконструкції лінії електропередачі у км напругою U, кВ (із зазначенням типу ліній електропередачі: повітряна лінія або кабельна лінія) за ступенями  04 */

        	(select
            	string_agg( enplanworkstate::varchar ,',') as enplanworkstate_pl_kl_04

            from (
            	select distinct
    				ac1.acttyperefcode as enplanworkstate
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
				where
					tcpw1.techconservicesrefcode = entechconditionsservcscode
					and ac1.acttyperefcode in (2/*РМ*/, 4/*КБ*/  )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in ( 2,	/*Повітряна лінія 0.4 кВ*/  11	/*Кабельні лінії 0.4-6-10 кВ*/ )

                    union all
                    select distinct pw1.staterefcode as enplanworkstate from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
					where tcpw1.techconservicesrefcode = entechconditionsservcscode
                      and pw1.staterefcode in (2/*РМ*/, 4/*КБ*/)
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 2,	/*Повітряна лінія 0.4 кВ*/  11	/*Кабельні лінії 0.4-6-10 кВ*/ )


        )as q1 ) )
 as enplanworkstate_pl_kl_04  ,


 ( /*Необхідність будівництва / реконструкції лінії електропередачі у км напругою U, кВ (із зазначенням типу ліній електропередачі: повітряна лінія або кабельна лінія) за ступенями
  04 RM */

        	(select
            	sum(coalesce(quantity_pl_kl_04_RM)) as quantity_pl_kl_04_RM

            from (
            	select coalesce(fm.quantity ,0) as quantity_pl_kl_04_RM
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
					inner join enplanwork pp on  (acpw1.plancode = pp.code and pp.kindcode=4 )
					inner join enestimateitem ii on pp.code=ii.planrefcode and ii.kindrefcode = 1
					inner join finmaterials fm on ii.code = fm.estimateitemrefcode and fm.statusrefcode = 1 and fm.cost<> 0
					inner join tkmaterials mm on ii.materialrefcode = mm.code and mm.measurementcode = 8/*КМ*/
				where
					tcpw1.techconservicesrefcode = entechconditionsservcscode
					and ac1.acttyperefcode in ( 2/*РМ*/  )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in ( 2,	/*Повітряна лінія 0.4 кВ*/  11	/*Кабельні лінії 0.4-6-10 кВ*/ )

                    union all
                    select coalesce(fm.quantity ,0) as quantity_pl_kl_04_RM from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
                    inner join enplanwork pp on  (pw1.code = pp.code and pp.kindcode=4 )
					inner join enestimateitem ii on pp.code=ii.planrefcode and ii.kindrefcode = 1
					inner join finmaterials fm on ii.code = fm.estimateitemrefcode and fm.statusrefcode = 1
					inner join tkmaterials mm on ii.materialrefcode = mm.code and mm.measurementcode = 8/*КМ*/
					where tcpw1.techconservicesrefcode = entechconditionsservcscode
                      and pw1.staterefcode in (2/*РМ*/ )
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 2,	/*Повітряна лінія 0.4 кВ*/  11	/*Кабельні лінії 0.4-6-10 кВ*/ )


        )as q1 ) )
 as quantity_pl_kl_04_RM ,

 ( /*Необхідність будівництва / реконструкції лінії електропередачі у км напругою U, кВ (із зазначенням типу ліній електропередачі: повітряна лінія або кабельна лінія) за ступенями
  04 KB */

        	(select
            	sum(coalesce(quantity_pl_kl_04_KB)) as quantity_pl_kl_04_KB

            from (
            	select coalesce(fm.quantity ,0) as quantity_pl_kl_04_KB
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
					inner join enplanwork pp on  (acpw1.plancode = pp.code and pp.kindcode=4 )
					inner join enestimateitem ii on pp.code=ii.planrefcode and ii.kindrefcode = 1
					inner join finmaterials fm on ii.code = fm.estimateitemrefcode and fm.statusrefcode = 1 and fm.cost<> 0
					inner join tkmaterials mm on ii.materialrefcode = mm.code and mm.measurementcode = 8/*КМ*/
				where
					tcpw1.techconservicesrefcode = entechconditionsservcscode
					and ac1.acttyperefcode in (4/*КБ*/ )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in ( 2,	/*Повітряна лінія 0.4 кВ*/  11	/*Кабельні лінії 0.4-6-10 кВ*/ )

                    union all
                    select coalesce(fm.quantity ,0) as quantity_pl_kl_04_KB from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
                    inner join enplanwork pp on  (pw1.code = pp.code and pp.kindcode=4 )
					inner join enestimateitem ii on pp.code=ii.planrefcode and ii.kindrefcode = 1
					inner join finmaterials fm on ii.code = fm.estimateitemrefcode and fm.statusrefcode = 1
					inner join tkmaterials mm on ii.materialrefcode = mm.code and mm.measurementcode = 8/*КМ*/
					where tcpw1.techconservicesrefcode = entechconditionsservcscode
                      and pw1.staterefcode in (4/*КБ*/  )
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 2,	/*Повітряна лінія 0.4 кВ*/  11	/*Кабельні лінії 0.4-6-10 кВ*/ )


        )as q1 ) )
 as quantity_pl_kl_04_KB ,

 /*endpl*/
    entechconditionsservcscode ,
    kki , kni , kfi ,
    kzti_nonstandard ,
    connectionkindrefcode ,
    kmisci_nonstandard ,
    ksvi_nonstandard,
    case when connectionkindrefcode = 1 then services.power * kki * kni * kfi else null end as resultStandardKoef ,
    case when connectionkindrefcode in (2,4) then services.power * kki * kni * kzti_nonstandard * kmisci_nonstandard * ksvi_nonstandard else null end as resultNonStandardKoef ,
    stavka ,
    buhstatusname,
    services.contractnumber
    , replace(services.partnername ,chr(10) , '' ) as  partnername
    , services.address
    , services.regiontype
    , services.trustfulnesscategory
    , services.voltagedegree
    , services.phasity
    , services.power
    , services.tycurrentpower
    , services.sum_payed
    , services.sum_calculated
    , services.int_regionaltype
    , coalesce((services.capital/1000)::numeric(15,3),0) as capital
    , coalesce((services.costs/1000)::numeric(15,3),0) as costs
    , coalesce((services.unmount/1000)::numeric(15,3),0) as unmount
    , services.connectionpowerplaces
    , services.connectionpowerpoint

    , services.sum_calculated -
     (coalesce((services.capital/1000)::numeric(15,3),0) +
      coalesce((services.costs/1000)::numeric(15,3),0)) as profit,
    services.sum_calculated::text || ' - (' || coalesce((services.capital/1000)::numeric(15,3),0)::text || ' + ' ||
    coalesce((services.costs/1000)::numeric(15,3),0)::text || ')' as profit_formula ,
    cnpackcode /*'Код пакета з EnergyWorkFlow'*/ ,
    cnsubsystemtyperefcode /*'Подсистемы цепочек'*/,
    personalaccountnumber,

	services.countLine04, services.countLine10,
	services.countLine35, services.countLine150,
	services.countTP04, services.countTP35,
	services.countTP110, services.countTP150 ,
	services.contragenttype,
    services.depname,
    coalesce((services.sum_project/1000)::numeric(15,3),0) as sum_project ,  -- ok 3 punkt

    coalesce((services.capital_tp_110_150/1000)::numeric(15,3),0) as sum_capital_tp_110_150, -- ok 4 punkt 1 kol
    coalesce((capital_tp_20_10/1000)::numeric(15,3),0) as sum_capital_tp_20_10, -- ok 4 punkt 2 kol

    coalesce((capital_line_110_150/1000)::numeric(15,3),0) as sum_capital_line_110_150, -- ok 5 punkt 1 kol
    coalesce((capital_line_10/1000)::numeric(15,3),0) as sum_capital_line_10, -- ok 5 punkt 2 kol
    coalesce((capital_line_04/1000)::numeric(15,3),0) as sum_capital_line_04 -- ok 5 punkt 3 kol
    , dateprov
    ,(SELECT enconnectionpowerpoint.name
  FROM enconnectionpowerpoint,
       entechconditionsobjcts,
       enservicesobject,
       enservicesobject2techcondtnsservices
  WHERE enconnectionpowerpoint.code = entechconditionsobjcts.powerpointrefcode
    AND
        entechconditionsobjcts.code = enservicesobject.techconobjectscode AND
        enservicesobject.code =
            enservicesobject2techcondtnsservices.servicesobjectrefcode AND
        enservicesobject2techcondtnsservices.techcondservrefcode =
            entechconditionsservcscode) as voltageservices /*Ступінь напруги в точці приєднання, кВ.*/
    , nodes_plainlist_normal_s150 /*ПС 150-110/35-27/10-6кВ*/
    , nodes_plainlist_normal_s35 /*ПС 35-27/10-6кВ*/
    , maxdateact /*Дата останнього акту ТО, КБ, РМ*/
from
(
 select tc.code as entechconditionsservcscode ,
 coalesce(( SELECT x.coef FROM net.enpowerreliabilityctgr x WHERE x.code = ct.categoryrefcode ),1) as kki ,
      coalesce(( SELECT p.coef FROM net.enconnectionpowerpoint p WHERE p.code = ct.powerpointrefcode ),1) as kni ,
      (select case when ct.phasityrefcode = 1 then
                   case when ct.powerpointrefcode in (1,5) then 1
                        when ct.powerpointrefcode in (2) then 1.55
                        when ct.powerpointrefcode in (3) then 2.15
                        when ct.powerpointrefcode in (4) then 2.85
                        else 1
                        end
	              when ct.phasityrefcode = 3 then
	                 case when ct.powerpointrefcode in (1,5) then 1
                        when ct.powerpointrefcode in (2) then 1.24
                        when ct.powerpointrefcode in (3) then 1.62
                        when ct.powerpointrefcode in (4) then 2.21
                        else 1
                        end
	              else 1 end
             )  as kfi ,
         ( select cons.constentry from enstandardconstentry cons where cons.constrefcode = 7 ) as kzti_nonstandard ,
         tc.connectionkindrefcode ,
         coalesce(( SELECT st.coef FROM net.enpowerreliabilityctgr x , ensettletype st WHERE x.code = ct.categoryrefcode and x.settletyperefcode=st.code  ),1) as kmisci_nonstandard ,
         coalesce(( SELECT p.coef FROM net.enconnectioninstlltntp p WHERE p.code = ct.installationtyperefcod ),1) as ksvi_nonstandard ,
         ct.installationtyperefcod ,
         ct.name as stavka  ,
        /*(select t.name
		 from entechconditionsservcs tcin, enconnectiontariffentr te, enconnectiontariff t
		 where te.tariffrefcode = t.code
		 and tcin.tariffentryrefcode = te.code
		 and tcin.code = tc.code
		) as stavka,*/
	    buhstatus."name" as buhstatusname ,
    	so.contractnumberservices||' / '||so.contractnumber||' від '||to_char(so.contractdate, 'dd.mm.yyyy')||' (ТУ № '||tob.numbergen||' від '||to_char(tob.dategen, 'dd.mm.yyyy')||')'  as contractnumber
        , so.contragentname||coalesce(' ('||so.contragentaddresswork||')','') as partnername
        , co.contragentaddresswork as address
		, coalesce(st.name, 'не визначено') as regiontype
		, pow.name as trustfulnesscategory
		, cop.name as voltagedegree
		, pha.name as phasity
		, round(cast((coalesce(tob.tyservicespower,0)+coalesce(tob.powergeneration,0)) as decimal), 2) as power
		, round(cast(tob.tycurrentpower as decimal), 2) as tycurrentpower
		, case when so.contractstatusrefcode = 5
		then coalesce(round(cast(tc.tysummagen as decimal), 2), 0)
		else 0 end as sum_payed
		--, coalesce(round(cast((tc.tysummagen - tc.tysummavat) / 1000 as decimal), 3), 0) as sum_calculated
		, coalesce((select sum(p2so.sumgen)/1000 from enpayment2so p2so
			 where p2so.paymenttyperefcode in (1,2)
			 and  p2so.servicesobjectrefcode = so.code )
			  ,0)::numeric(15,3) as sum_calculated

		, st.code as int_regionaltype
		, ( /*Капитальные затраты (проектирование)*/
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/* SUPP-86501 снова добавить SUPP-71612 добавить тип акта ТО ( SUPP-76635 от24102018 снова убрать нада ) )*/
					,20/*SUPP-92977 Акт виконаних робіт договорів підряду*/) /*Проектування*/

                    ) as query1

                    union all

                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal),2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and  pw1.typerefcode = 19
                       ) as query2) as query
        )
        /* + SUPP-71612 добавить стоимость счетчика (SUPP-76635 от24102018 снова убрать нада )  coalesce((select coalesce(sum(sc.cost), 0) as sum_by_act
											        from sccounter sc, enestimateitem es, enact2enplanwork ena2, enact a,
											             entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
											       where a.code = ena2.actrefcode
											         and sc.estimateitemrefcode = es.code
											         and t2p.planrefcode = ena2.plancode
											         and so2tc.techcondservrefcode = t2p.techconservicesrefcode
											         and so2tc.servicesobjectrefcode = so.code
											         and es.countfact <> 0
											         and es.kindrefcode = 1
											         and ena2.plancode = es.planrefcode ),0) */ as capital
        , /* Затраты на себестоимость (Проектирование) - по бюджетодержателю ВПТУ */
        (
        	select
            	round(cast(sum(net.get_sum_by_act_services(ac1.code)) as decimal), 2)
            from
            	enact as ac1
            where
            	ac1.elementcode = so.elementcode
        ) as costs
		, (
        select round(cast(sum(cost) as decimal), 2)
        from
        (select
        	sum(ma1.cost) as cost
        from
    		enplanwork as pw1
            inner join entechcond2planwork as tcpw1 on tcpw1.planrefcode = pw1.code
            inner join enestimateitem as es1 on es1.planrefcode = pw1.code
            inner join finmaterials as ma1 on es1.code = ma1.estimateitemrefcode
        where
			tcpw1.techconservicesrefcode = tc.code
        	and pw1.kindcode = 4
            and ma1.statusrefcode = 1
            and es1.kindrefcode = 3
            and ma1.cost <> 0

            union all

        select
        	sum(ma1.cost) as cost
        from
    		enplanwork as pw1
            inner join enestimateitem as es1 on es1.planrefcode = pw1.code
            inner join finmaterials as ma1 on es1.code = ma1.estimateitemrefcode
        where
        	pw1.elementrefcode = so.elementcode
        	and pw1.kindcode = 4
            and ma1.statusrefcode = 1
            and es1.kindrefcode = 3
            and ma1.cost <> 0) as unmount_subquery
        	) as unmount
			, tob.connectionpowerplaces
            , coalesce(cop.name, '') as connectionpowerpoint
            , so.cnpackcode /*'Код пакета з EnergyWorkFlow'*/
            , so.cnsubsystemtyperefcode /*'Подсистемы цепочек'*/
            , so.personalaccountnumber

			, necessitybuilding.countLine04 as countLine04, necessitybuilding.countLine10 as countLine10
			, necessitybuilding.countLine35 as countLine35, necessitybuilding.countLine150 as countLine150
			, necessitybuilding.countTP04 as countTP04, necessitybuilding.countTP35 as countTP35
			, necessitybuilding.countTP110 as countTP110, necessitybuilding.countTP150 as countTP150
          , (select enservicescontragenttp."name" from  enservicescontragenttp where enservicescontragenttp.code = so.contragenttyperefcode ) as contragenttype
          , depsobjcts.name as depname
          /*new fields*/
          , ( /* Вартість проектної документації на будівництво електричних мереж від точки забезпечення потужності до межі балансової належності, тис. грн.  */
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29)
                    ) as query1

                    ) as query
        ) as sum_project /*Вартість проектної документації  == суми по актам з типом “Проектування” */

        , ( /*Фактичні капітальні витрати на будівництво / реконструкцію підстанцій
              Основні мережі 110(150)-35 кВ, Вроз, тис.грн  */
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in ( 2, 4  )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in (   6, /*Подстанция 35-150 кВ*/
											  26 /*Об`єкти групи обліку на ПС 150-35-10*/
                                             )
                    ) as query1

                    union all

                    select round(cast(sum((select fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal),2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
					where tcpw1.techconservicesrefcode = tc.code
                      and pw1.staterefcode in ( 2, 4)
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 6, /*Подстанция 35-150 кВ*/
											  26 /*Об`єкти групи обліку на ПС 150-35-10*/
                                             )
                 ) as query2
             ) as query
        )
 as capital_tp_110_150


 , ( /*Фактичні капітальні витрати на будівництво / реконструкцію підстанцій
              20(10)6/0,4, Вфакт.тр   */
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in ( 2, 4  )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in (  3 )
                    ) as query1

                    union all

                    select round(cast(sum((select fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal),2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
					where tcpw1.techconservicesrefcode = tc.code
                      and pw1.staterefcode in ( 2, 4)
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 3	/*ТП 0.4 кВ*/ )
                 ) as query2
             ) as query
        )
 as capital_tp_20_10

 , ( /*Фактичні капітальні витрати на будівництво / реконструкцію ліній електропередавання Вфакт.лін, тис.грн*/
     /*Основні мережі 110(150)-35 кВ*/
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in ( 2, 4  )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in (  5 )
                    ) as query1

                    union all

                    select round(cast(sum((select fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal),2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
					where tcpw1.techconservicesrefcode = tc.code
                      and pw1.staterefcode in ( 2, 4)
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 5  )
                 ) as query2
             ) as query
        )
 as capital_line_110_150

 , ( /*Фактичні капітальні витрати на будівництво / реконструкцію ліній електропередавання Вфакт.лін, тис.грн*/
     /*20(10)6 кВ*/
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in ( 2, 4  )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in (  1 )
                    ) as query1

                    union all

                    select round(cast(sum((select fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal),2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
					where tcpw1.techconservicesrefcode = tc.code
                      and pw1.staterefcode in ( 2, 4)
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 1 )
                 ) as query2
             ) as query
        )
 as capital_line_10

 , ( /*Фактичні капітальні витрати на будівництво / реконструкцію ліній електропередавання Вфакт.лін, тис.грн*/
     /*0,4(0,23)*/
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement as el on el.code = ac1.elementcode
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in ( 2, 4  )
                    and ac1.statusrefcode = 3
                    and el.typerefcode in (  2 )
                    ) as query1

                    union all

                    select round(cast(sum((select fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal),2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on pw1.code = a2p.plancode
                    inner join enact aa on a2p.actrefcode = aa.code
                    inner join enelement el on aa.elementcode = el.code
					where tcpw1.techconservicesrefcode = tc.code
                      and pw1.staterefcode in ( 2, 4)
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 2 )
                 ) as query2
             ) as query
        )
 as capital_line_04
 , (select to_char(s2p.dateposting,'dd.mm.yyyy') from enservicesobject2prov s2p where s2p.servicesobjectrefcode = so.code  ) as dateprov
 , tob.voltageservices as voltageservices /*Ступінь напруги в точці приєднання, кВ.*/
 , ( select npln.s150 from enso2node s2n , nodes_plainlist_normal npln where s2n.servicesobjectcode = so.code and npln.code = s2n.ccnodecode limit 1  ) as nodes_plainlist_normal_s150 /*ПС 150-110/35-27/10-6кВ*/
 , ( select npln.s35 from enso2node s2n , nodes_plainlist_normal npln where s2n.servicesobjectcode = so.code and npln.code = s2n.ccnodecode limit 1  ) as nodes_plainlist_normal_s35 /*ПС 35-27/10-6кВ*/
 ,(select max(a.dateact) from enact a where
			      a.acttyperefcode in ( 2, 3, 4 )
			      and a.code in (
							      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
							      select pl.code
									      from enplanwork pl, entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
									      where pl.code = t2p.planrefcode
									      and so2tc.techcondservrefcode = t2p.techconservicesrefcode
									      and so2tc.servicesobjectrefcode = so.code
										  and pl.typerefcode not in (8 , /*19 SUPP-74743 */  20 , 22) /*SUPP-71512*/
										  and coalesce(pl.ddscodescode,0) not in ( select code from  rqddscodes where txtcode = '332 100' )
							      )
			                 )
			     ) as maxdateact
	from
		enservicesobject as so
		inner join enservicesobjectstatus as buhstatus on so.statusrefcode = buhstatus.code
		inner join enservicesobject2techcondtnsservices as so2tc on so.code = so2tc.servicesobjectrefcode
        inner join entechconditionsservcs as tc on so2tc.techcondservrefcode = tc.code
        inner join encontragent as co on tc.code = co.techcondservicesrefcod
        inner join entechconditionsobjcts as tob on co.techconobjectscode = tob.code
        left join enconnectiontariffentr as tf on tc.tariffentryrefcode = tf.code
		left join enconnectiontariff as ct on tf.tariffrefcode = ct.code
		left join enpowerreliabilityctgr as pow on ct.categoryrefcode = pow.code
    	left join ensettletype as st on pow.settletyperefcode = st.code
		left join enconnectionpowerpoint as cop on ct.powerpointrefcode = cop.code
		left join enconnectionphasity as pha on ct.phasityrefcode = pha.code
		left join enpriconnectiondata as pda on tc.code = pda.techcondservrefcode
        left join endepartment as dep on so.departmentcode = dep.code
		left join endepartment as depsobjcts on tob.departmentcode = depsobjcts.code

		left join (
		select w.socode,
			sum(w.countLine04)::varchar || ' ' ||  string_agg(descriptionLine04 ,' ')  as countLine04,
			sum(w.countLine10)::varchar || ' ' ||  string_agg(descriptionLine10 ,' ') as countLine10,
			sum(w.countLine35)::varchar || ' ' ||  string_agg(descriptionLine35 ,' ') as countLine35,
			sum(w.countLine150)::varchar || ' ' ||  string_agg(descriptionLine150 ,' ') as countLine150,
			sum(w.countTP04)::varchar || ' ' ||  string_agg(descriptionTP04 ,' ') as countTP04,
			sum(w.countTP35)::varchar || ' ' ||  string_agg(descriptionTP35 ,' ') as countTP35,
			sum(w.countTP110)::varchar || ' ' ||  string_agg(descriptionTP110 ,' ') as countTP110,
			sum(w.countTP150)::varchar || ' ' ||  string_agg(descriptionTP150 ,' ') as countTP150
		from (
		select n.servicesobjectrefcode as socode,
			-- Повітряна лінія 0.4 кВ
			case when n.elementtyperefcode = 2
			then sum(n.countgen)  else 0 end as countLine04,
			-- Повітряна лінія 6-10 кВ
			case when n.elementtyperefcode = 1
				then sum(n.countgen) else 0 end as countLine10,
			-- Повітряна лінія 35 кВ
			case when n.elementtyperefcode = 5 and n.voltagenominalcode = 3
				then sum(n.countgen) else 0 end as countLine35,
			-- Повітряна лінія 150 кВ
			case when n.elementtyperefcode = 5 and n.voltagenominalcode in (1, 2)
				then sum(n.countgen) else 0 end as countLine150,
			-- ТП 0.4 кВ
			case when n.elementtyperefcode = 3
				then sum(n.countgen) else 0 end as countTP04,
			-- Подстанция 35 кВ
			case when n.elementtyperefcode = 6 and n.voltagenominalcode = 3
				then sum(n.countgen) else 0 end as countTP35,
			-- Подстанция 35-110 кВ
			case when n.elementtyperefcode = 6 and n.voltagenominalcode = 2
				then sum(n.countgen) else 0 end as countTP110,
			-- Подстанция 35-150 кВ
			case when n.elementtyperefcode = 6 and n.voltagenominalcode = 1
				then sum(n.countgen) else 0 end as countTP150

			-- Повітряна лінія 0.4 кВ
			, case when n.elementtyperefcode = 2
			then n.description  else '' end as descriptionLine04,
			-- Повітряна лінія 6-10 кВ
			case when n.elementtyperefcode = 1
				then n.description else '' end as descriptionLine10,
			-- Повітряна лінія 35 кВ
			case when n.elementtyperefcode = 5 and n.voltagenominalcode = 3
				then n.description else '' end as descriptionLine35,
			-- Повітряна лінія 150 кВ
			case when n.elementtyperefcode = 5 and n.voltagenominalcode in (1, 2)
				then n.description else '' end as descriptionLine150,
			-- ТП 0.4 кВ
			case when n.elementtyperefcode = 3
				then n.description else '' end as descriptionTP04,
			-- Подстанция 35 кВ
			case when n.elementtyperefcode = 6 and n.voltagenominalcode = 3
				then n.description else '' end as descriptionTP35,
			-- Подстанция 35-110 кВ
			case when n.elementtyperefcode = 6 and n.voltagenominalcode = 2
				then n.description else '' end as descriptionTP110,
			-- Подстанция 35-150 кВ
			case when n.elementtyperefcode = 6 and n.voltagenominalcode = 1
				then n.description  else '' end as descriptionTP150
		from ennecessitybuilding n
		group by n.elementtyperefcode, n.servicesobjectrefcode, n.voltagenominalcode , n.description ) w
		group by w.socode) necessitybuilding on so.code = necessitybuilding.socode

	where
		 so.contracttyperefcode = 5
		 and so.contractkindrefcode = 1
		 and tc.connectionkindrefcode in (1,2,4)
        		/*Код договора*/
        and case when  $P{tcsCode}::integer > 0
        		then tc.code =  $P{tcsCode}::integer
                else -1 = -1
			end
		/* max дата акта РМ, КБ або ТО */
       and
	   (	(
		 (select max(a.dateact) from enact a where
		      a.acttyperefcode in ( 2, 3, 4 )
		      and a.code in (
						      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
						      select pl.code
							      from enplanwork pl, entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
							      where pl.code = t2p.planrefcode
							      and so2tc.techcondservrefcode = t2p.techconservicesrefcode
							      and so2tc.servicesobjectrefcode = so.code
								  and pl.typerefcode not in (8 , /*19 SUPP-74743 */ 20 , 22) /*SUPP-71512*/
								  and coalesce(pl.ddscodescode,0) not in ( select code from  rqddscodes where txtcode = '332 100' )
						      )
		                 )
		     ) >=  $P{dateStart}
		 and
		 (select max(a.dateact) from enact a where
		      a.acttyperefcode in ( 2, 3, 4 )
		      and a.code in (
						      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
						      select pl.code
								      from enplanwork pl, entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
								      where pl.code = t2p.planrefcode
								      and so2tc.techcondservrefcode = t2p.techconservicesrefcode
								      and so2tc.servicesobjectrefcode = so.code
									  and pl.typerefcode not in (8 , /*19 SUPP-74743 */  20 , 22) /*SUPP-71512*/
									  and coalesce(pl.ddscodescode,0) not in ( select code from  rqddscodes where txtcode = '332 100' )
						      )
		                 )
		     ) <=  $P{dateFinal}
		 and $P{po_date_provodki} = 0
		)
      OR ( (select s2p.dateposting from enservicesobject2prov s2p where s2p.servicesobjectrefcode = so.code  ) BETWEEN $P{dateStart} and $P{dateFinal}
		   and $P{po_date_provodki} = 1)
       )
		 and so.contractstatusrefcode not in (2,8) /*не скасовані чи відмінені*/
        /*Ознака: місто / село */
         and case when $P{isCityVillage} = 1
        		then coalesce(st.code, -1) = 0
                when $P{isCityVillage} = 2
                then coalesce(st.code, -1) = 1
                else -1 = -1
			end
        /*Тип приєднання - стандартне / нестандартне*/
        and case when $P{isStandardNonStandard} = 2 then coalesce(tc.connectionkindrefcode, -1) in (2,4)
                 when $P{isStandardNonStandard} = 1 then coalesce(tc.connectionkindrefcode, -1) in (1)
            else -1 = -1
			end


    union all /* union2 */

	select
	tc.code as entechconditionsservcscode ,
	1 as kki , 1 as kni , 1 as kfi ,
	( select cons.constentry from enstandardconstentry cons where cons.constrefcode = 7 ) as kzti_nonstandard ,
	     tc.connectionkindrefcode ,
	     coalesce(( SELECT st.coef FROM net.enpowerreliabilityctgr x , ensettletype st WHERE x.code = ct.categoryrefcode and x.settletyperefcode=st.code  ),1) as kmisci_nonstandard ,
	   coalesce(( SELECT p.coef FROM net.enconnectioninstlltntp p WHERE p.code = ct.installationtyperefcod ),1) as ksvi_nonstandard ,
	   ct.installationtyperefcod ,
	   ct.name as stavka  ,
	   '' as buhstatusname ,
		tc.contractnumber||' / '||tc.fincontractnumber||' від '||to_char(tc.fincontractdate, 'dd.mm.yyyy')||' (ТУ № '||tob.numbergen||' від '||to_char(tob.dategen, 'dd.mm.yyyy')||')' as contractnumber
        , tc.partnername||coalesce(' ('||co.contragentaddresswork||')','') as partnername
        , co.contragentaddresswork as address
        , coalesce(st.name, 'не визначено') as regiontype
		, pow.name as trustfulnesscategory
		, cop.name as voltagedegree
		, pha.name as phasity
		, round(cast((coalesce(tob.tyservicespower,0)+coalesce(tob.powergeneration,0)) as decimal), 2) as power
		, round(cast(tob.tycurrentpower as decimal), 2) as tycurrentpower
		, tc.tysummagen as sum_payed
		-- , coalesce(round(cast((tc.tysummagen - tc.tysummavat) / 1000 as decimal), 3), 0) as sum_calculated
		, coalesce((select sum(p2so.sumgen)/1000 from enpayment2so p2so
			 where p2so.paymenttyperefcode in (1,2)
			  and  p2so.servicesobjectrefcode in ( select s2t.servicesobjectrefcode from enservicesobject2techcondtnsservices s2t
			                                        where s2t.techcondservrefcode  = tc.code      )
			  )
			  ,0)::numeric(15,3) as sum_calculated
		, st.code as int_regionaltype
        		, ( /*Капитальные затраты (проектирование)*/
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 /*, 3SUPP-71612 добавить тип акта ТО ( SUPP-76635 от24102018 снова убрать нада ) ) */
					,20/*SUPP-92977 Акт виконаних робіт договорів підряду*/ ) /*Проектування*/
                    ) as query1

                    union all

                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal), 2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and pw1.typerefcode = 19) as query2) as query
        )  /* + SUPP-71612 добавить стоимость счетчика (SUPP-76635 от24102018 снова убрать нада)   coalesce((select coalesce(sum(sc.cost), 0) as sum_by_act
											        from sccounter sc, enestimateitem es, enact2enplanwork ena2, enact a,
											             entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
											       where a.code = ena2.actrefcode
											         and sc.estimateitemrefcode = es.code
											         and t2p.planrefcode = ena2.plancode
											         and so2tc.techcondservrefcode = t2p.techconservicesrefcode
											         and so2tc.techcondservrefcode = tc.code
											         and es.countfact <> 0
											         and es.kindrefcode = 1
											         and ena2.plancode = es.planrefcode ),0) */ as capital
        , /* Затраты на себестоимость (Проектирование) - по бюджетодержателю ВПТУ */
        (
        	select
            	round(cast(sum(net.get_sum_by_act_services(ac1.code)) as decimal), 2)
            from
            	enact as ac1
            where
            	ac1.elementcode = tc.elementcode
        ) as costs
		, (
        select round(cast(sum(cost) as decimal), 2)
        from
        (select
        	sum(ma1.cost) as cost
        from
    		enplanwork as pw1
            inner join entechcond2planwork as tcpw1 on tcpw1.planrefcode = pw1.code
            inner join enestimateitem as es1 on es1.planrefcode = pw1.code
            inner join finmaterials as ma1 on es1.code = ma1.estimateitemrefcode
        where
			tcpw1.techconservicesrefcode = tc.code
        	and pw1.kindcode = 4
            and ma1.statusrefcode = 1
            and es1.kindrefcode = 3
            and ma1.cost <> 0

            union all

        select
        	round(cast(sum(ma1.cost) as decimal), 2) as cost
        from
    		enplanwork as pw1
            inner join enestimateitem as es1 on es1.planrefcode = pw1.code
            inner join finmaterials as ma1 on es1.code = ma1.estimateitemrefcode
        where
        	pw1.elementrefcode = tc.elementcode
        	and pw1.kindcode = 4
            and ma1.statusrefcode = 1
            and es1.kindrefcode = 3
            and ma1.cost <> 0) as unmount_subquery
        	) as unmount
            , tob.connectionpowerplaces
            , coalesce(cop.name, '') as connectionpowerpoint

            , tc.cnpackcode /*'Код пакета з EnergyWorkFlow'*/
            , tc.cnsubsystemtyperefcode /*'Подсистемы цепочек'*/
            , '' as personalaccountnumber

			, '' as countLine04, '' as countLine10
			, '' as countLine35, '' as countLine150
			, '' as countTP04, '' as countTP35
			, '' as countTP110, '' as countTP150
, (select enservicescontragenttp."name" from  enservicescontragenttp where enservicescontragenttp.code = co.contragenttypecode ) as contragenttype
, depsobjcts.name as depname
/*new fields*/
/*Вартість проектної документації на будівництво електричних мереж від точки забезпечення потужності до межі балансової належності, тис. грн.*/
      , (    select round(cast(sum(sums) as decimal), 2) from
    	(select
        	sum(net.get_sum_by_act(act_code)) as sums
        from (
        	select distinct
				ac1.code as act_code
			from
            	entechcond2planwork as tcpw1
				inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
				inner join enact as ac1 on acpw1.actrefcode = ac1.code
			where
				tcpw1.techconservicesrefcode = tc.code
				and ac1.acttyperefcode in ( 29 )
                ) as query1
        ) as query
    )  as sum_project

    , ( /*Фактичні капітальні витрати на будівництво / реконструкцію підстанцій
              Основні мережі 110(150)-35 кВ, Вроз, тис.грн  */
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement el on ac1.elementcode= el.code
				where tcpw1.techconservicesrefcode = tc.code
				  and ac1.acttyperefcode in ( 2, 4)
                  and ac1.statusrefcode = 3
                  and el.typerefcode in ( 6,	/*Подстанция 35-150 кВ*/
										  26 /*Об`єкти групи обліку на ПС 150-35-10*/
                                             )
                    ) as query1

                    union all

                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal), 2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on a2p.plancode = pw1.code
                    inner join enact aa on aa.code = a2p.actrefcode
                    inner join enelement el on el.code =aa.elementcode
					where tcpw1.techconservicesrefcode = tc.code
                      and pw1.staterefcode in ( 2, 4)
                      and aa.statusrefcode = 3
                      and el.typerefcode in ( 6,	/*Подстанция 35-150 кВ*/
											  26 /*Об`єкти групи обліку на ПС 150-35-10*/
                                             )
                    ) as query2
                ) as query
        )  as capital_tp_110_150

        , ( /*Фактичні капітальні витрати на будівництво / реконструкцію підстанцій
              20(10)6/0,4, Вфакт.тр,  */
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement el on ac1.elementcode= el.code
				where tcpw1.techconservicesrefcode = tc.code
				  and ac1.acttyperefcode in ( 2, 4)
                  and ac1.statusrefcode = 3
                  and el.typerefcode in (   3 /*ТП 0.4 кВ*/ )
                    ) as query1

                    union all

                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal), 2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on a2p.plancode = pw1.code
                    inner join enact aa on aa.code = a2p.actrefcode
                    inner join enelement el on el.code =aa.elementcode
					where tcpw1.techconservicesrefcode = tc.code
                      and pw1.staterefcode in ( 2, 4)
                      and aa.statusrefcode =  3
                      and el.typerefcode in ( 3 	/*ТП 0.4 кВ*/ )
                    ) as query2
                ) as query
        )  as capital_tp_20_10

       , ( /* Фактичні капітальні витрати на будівництво / реконструкцію ліній електропередавання Вфакт.лін, тис.грн*/
           /* Основні мережі 110(150)-35 кВ */
           select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement el on ac1.elementcode= el.code
				where tcpw1.techconservicesrefcode = tc.code
				  and ac1.acttyperefcode in ( 2, 4)
                  and ac1.statusrefcode = 3
                  and el.typerefcode in ( 5	 )
                    ) as query1

                    union all

                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal), 2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on a2p.plancode = pw1.code
                    inner join enact aa on aa.code = a2p.actrefcode
                    inner join enelement el on el.code =aa.elementcode
					where tcpw1.techconservicesrefcode = tc.code
                      and pw1.staterefcode in ( 2, 4)
                      and aa.statusrefcode =  3
                      and el.typerefcode in ( 5	)
                    ) as query2
                ) as query
        )  as capital_line_110_150


         , ( /* Фактичні капітальні витрати на будівництво / реконструкцію ліній електропередавання Вфакт.лін, тис.грн*/
           /* 20(10)6 кВ */
           select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement el on ac1.elementcode= el.code
				where tcpw1.techconservicesrefcode = tc.code
				  and ac1.acttyperefcode in ( 2, 4)
                  and ac1.statusrefcode = 3
                  and el.typerefcode in (1 )
                    ) as query1

                    union all

                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal), 2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on a2p.plancode = pw1.code
                    inner join enact aa on aa.code = a2p.actrefcode
                    inner join enelement el on el.code =aa.elementcode
					where tcpw1.techconservicesrefcode = tc.code
                      and pw1.staterefcode in ( 2, 4)
                      and aa.statusrefcode =  3
                      and el.typerefcode in (1)
                    ) as query2
                ) as query
        )  as capital_line_10

        , ( /* Фактичні капітальні витрати на будівництво / реконструкцію ліній електропередавання Вфакт.лін, тис.грн*/
           /* 0,4(0,23) */
           select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
					inner join enelement el on ac1.elementcode= el.code
				where tcpw1.techconservicesrefcode = tc.code
				  and ac1.acttyperefcode in ( 2, 4)
                  and ac1.statusrefcode = 3
                  and el.typerefcode in (2 )
                    ) as query1

                    union all

                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal), 2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
                    inner join enact2enplanwork a2p on a2p.plancode = pw1.code
                    inner join enact aa on aa.code = a2p.actrefcode
                    inner join enelement el on el.code =aa.elementcode
					where tcpw1.techconservicesrefcode = tc.code
                      and pw1.staterefcode in ( 2, 4)
                      and aa.statusrefcode =  3
                      and el.typerefcode in (2)
                    ) as query2
                ) as query
        )  as capital_line_04
        , ''  as dateprov
 , tob.voltageservices as voltageservices /*Ступінь напруги в точці приєднання, кВ.*/
 , '' as nodes_plainlist_normal_s150 /*ПС 150-110/35-27/10-6кВ*/
 , '' as nodes_plainlist_normal_s35 /*ПС 35-27/10-6кВ*/
 , (select max(a.dateact) from enact a where
		      a.acttyperefcode in ( 2, 3, 4 )
		      and a.code in (
						      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
						      select pl.code
						      from enplanwork pl
						      where pl.elementrefcode = tc.elementcode
							  and pl.typerefcode not in (8 /*19 SUPP-74743 */ , 20 , 22) /*SUPP-71512*/
							  and coalesce(pl.ddscodescode,0) not in ( select code from  rqddscodes where txtcode = '332 100' )
						      )
		                 )
		     ) as maxdateact
	from
		entechconditionsservcs as tc
        inner join encontragent as co on tc.code = co.techcondservicesrefcod
        inner join entechconditionsobjcts as tob on co.techconobjectscode = tob.code
        left join enconnectiontariffentr as tf on tc.tariffentryrefcode = tf.code
        left join enconnectiontariff as ct on tf.tariffrefcode = ct.code
		left join enpowerreliabilityctgr as pow on ct.categoryrefcode = pow.code
    	left join ensettletype as st on pow.settletyperefcode = st.code
		left join enconnectionpowerpoint as cop on ct.powerpointrefcode = cop.code
		left join enconnectionphasity as pha on ct.phasityrefcode = pha.code
		left join enpriconnectiondata as pda on tc.code = pda.techcondservrefcode
        left join endepartment as dep on dep.code = tc.departmentcode
		left join endepartment as depsobjcts on tob.departmentcode = depsobjcts.code
	where
		tc.connectionkindrefcode in (1, 2 , 4)
		and tc.techcondservicestypecd in (1, 2)

        		/*Код договора*/
        and case when $P{tcsCode}::integer > 0
        		then tc.code = $P{tcsCode}::integer
                else -1 = -1
			end

		and tc.code not in (select s2t.techcondservrefcode from enservicesobject2techcondtnsservices s2t)
		/* max дата акта РМ, КБ або ТО */
		and(
		 (select max(a.dateact) from enact a where
		      a.acttyperefcode in ( 2, 3, 4 )
		      and a.code in (
						      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
						      select pl.code
						      from enplanwork pl
						      where pl.elementrefcode = tc.elementcode
							  and pl.typerefcode not in (8 /*19 SUPP-74743 */ , 20 , 22) /*SUPP-71512*/
							  and coalesce(pl.ddscodescode,0) not in ( select code from  rqddscodes where txtcode = '332 100' )
						      )
		                 )
		     ) >=  $P{dateStart}
		 and
		 (select max(a.dateact) from enact a where
		      a.acttyperefcode in ( 2, 3, 4 )
		      and a.code in (
						      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
						      select pl.code
						      from enplanwork pl
						      where pl.elementrefcode = tc.elementcode
							  and pl.typerefcode not in (8 /*19 SUPP-74743 */ , 20 , 22) /*SUPP-71512*/
							  and coalesce(pl.ddscodescode,0) not in ( select code from  rqddscodes where txtcode = '332 100' )
						      )
		                 )
		     ) <=  $P{dateFinal}

		     and $P{po_date_provodki} = 0
		)



		/*Ознака - місто / село*/
        and case when $P{isCityVillage} = 1
        		then coalesce(st.code, -1) = 0
                when $P{isCityVillage} = 2
                then coalesce(st.code, -1) = 1
                else -1 = -1
			end
        /*Тип приєднання - стандартне / нестандартне*/
        and case when $P{isStandardNonStandard} = 2 then coalesce(tc.connectionkindrefcode, -1) in (2,4)
                 when $P{isStandardNonStandard} = 1 then coalesce(tc.connectionkindrefcode, -1) in (1)
            else -1 = -1
			end



	order by contractnumber
) as services
 where
case when $P{isWithoutCapitalCosts} = 1
	then coalesce(services.capital, 0) > 0
	else 0 = 0
end
and
case when $P{isWithoutZeroPayment} = 1
	then coalesce(services.sum_calculated, 0) > 0
	else 0 = 0
end
) q1]]>
	</queryString>
	<field name="contractnumber" class="java.lang.String">
		<fieldDescription><![CDATA[Номер договору]]></fieldDescription>
	</field>
	<field name="partnername" class="java.lang.String">
		<fieldDescription><![CDATA[Найменування організації]]></fieldDescription>
	</field>
	<field name="address" class="java.lang.String">
		<fieldDescription><![CDATA[Адрес потребителя]]></fieldDescription>
	</field>
	<field name="regiontype" class="java.lang.String"/>
	<field name="trustfulnesscategory" class="java.lang.String"/>
	<field name="voltagedegree" class="java.lang.String"/>
	<field name="phasity" class="java.lang.String"/>
	<field name="power" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[Мощность, кВА]]></fieldDescription>
	</field>
	<field name="sum_payed" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[Сума]]></fieldDescription>
	</field>
	<field name="int_regionaltype" class="java.lang.Double"/>
	<field name="unmount" class="java.math.BigDecimal"/>
	<field name="capital" class="java.math.BigDecimal"/>
	<field name="costs" class="java.math.BigDecimal"/>
	<field name="sum_calculated" class="java.math.BigDecimal"/>
	<field name="connectionpowerplaces" class="java.lang.String">
		<fieldDescription><![CDATA[Точка забезпечення потужності: назва лінії електропередачі та номер опори (відстань до кабельної врізки) та/або назва (номер) підстанції згідно із системою кодифікації назв]]></fieldDescription>
	</field>
	<field name="connectionpowerpoint" class="java.lang.String">
		<fieldDescription><![CDATA[Ступінь напруги в точці приєднання, кВ.]]></fieldDescription>
	</field>
	<field name="profit" class="java.math.BigDecimal"/>
	<field name="profit_formula" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="cnpackcode" class="java.lang.Integer"/>
	<field name="cnsubsystemtyperefcode" class="java.lang.Integer"/>
	<field name="personalaccountnumber" class="java.lang.String"/>
	<field name="countLine04" class="java.lang.String"/>
	<field name="countLine10" class="java.lang.String"/>
	<field name="countLine35" class="java.lang.String"/>
	<field name="countLine150" class="java.lang.String"/>
	<field name="countTP04" class="java.lang.String"/>
	<field name="countTP35" class="java.lang.String"/>
	<field name="countTP110" class="java.lang.String"/>
	<field name="countTP150" class="java.lang.String"/>
	<field name="contragenttype" class="java.lang.String"/>
	<field name="buhstatusname" class="java.lang.String"/>
	<field name="depname" class="java.lang.String"/>
	<field name="stavka" class="java.lang.String"/>
	<field name="sum_project" class="java.math.BigDecimal"/>
	<field name="sum_capital_tp_110_150" class="java.math.BigDecimal"/>
	<field name="sum_capital_tp_20_10" class="java.math.BigDecimal"/>
	<field name="sum_capital_line_110_150" class="java.math.BigDecimal"/>
	<field name="sum_capital_line_10" class="java.math.BigDecimal"/>
	<field name="sum_capital_line_04" class="java.math.BigDecimal"/>
	<field name="kki" class="java.math.BigDecimal"/>
	<field name="kni" class="java.math.BigDecimal"/>
	<field name="kfi" class="java.math.BigDecimal"/>
	<field name="kzti_nonstandard" class="java.math.BigDecimal"/>
	<field name="connectionkindrefcode" class="java.math.BigDecimal"/>
	<field name="kmisci_nonstandard" class="java.math.BigDecimal"/>
	<field name="ksvi_nonstandard" class="java.math.BigDecimal"/>
	<field name="resultStandardKoef" class="java.math.BigDecimal"/>
	<field name="resultNonStandardKoef" class="java.math.BigDecimal"/>
	<field name="dateprov" class="java.lang.String"/>
	<field name="voltageservices" class="java.lang.String"/>
	<field name="nodes_plainlist_normal_s150" class="java.lang.String"/>
	<field name="nodes_plainlist_normal_s35" class="java.lang.String"/>
	<field name="maxdateact" class="java.util.Date"/>
	<field name="tycurrentpower" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="enplanworkstate_ps_35_110_150" class="java.lang.String"/>
	<field name="enplanworkstate_ps_10_6_04" class="java.lang.String"/>
	<field name="enplanworkstate_pl_35_150" class="java.lang.String"/>
	<field name="enplanworkstate_pl_10_6" class="java.lang.String"/>
	<field name="enplanworkstate_pl_kl_04" class="java.lang.String"/>
	<variable name="cost_fact" class="java.math.BigDecimal"/>
	<variable name="companyShortName" class="java.lang.String">
		<variableExpression><![CDATA[$V{companyShortName}]]></variableExpression>
		<initialValueExpression><![CDATA[((com.ksoe.energynet.reports.common.FINScriptlet)$P{REPORT_SCRIPTLET}).getSettings("company.shortname")]]></initialValueExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="154" splitType="Stretch">
			<textField isBlankWhenNull="false">
				<reportElement key="textField-18" x="0" y="0" width="1890" height="154"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="24"/>
				</textElement>
				<textFieldExpression><![CDATA["Інформація " + $V{companyShortName} + "\n" +
"фактичних витрат з приєднання електроустановок (збільшення потужності існуючих) для електроустановок замовників (першого, другого, третього ступеня) приєднання, в (сільській, міській) місцевості, в Херсонській області \n " +
" з " + new SimpleDateFormat("dd.MM.yyyy").format($P{dateStart}) + " по " + new SimpleDateFormat("dd.MM.yyyy").format($P{dateFinal})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="statAddition" x="1890" y="0" width="200" height="29"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Top" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Додаток до листа НКРЕ від 01.04.13 №2244/26/47-13]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="238" splitType="Stretch">
			<staticText>
				<reportElement key="statNumber" x="0" y="0" width="50" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[№ п/п]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="0" y="205" width="50" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[1]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTwo" x="50" y="205" width="180" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[2]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexThree" x="230" y="205" width="180" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[3]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNumberAndDateOfAgreement" x="50" y="0" width="180" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Номер та дата договору про приєднання (технічних умов)]]></text>
			</staticText>
			<staticText>
				<reportElement key="statPartner" x="230" y="0" width="180" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Замовник (найменування, місцезнаходження, прізвище, ім'я, по-батькові, місце проживання)]]></text>
			</staticText>
			<staticText>
				<reportElement key="statCapacity" x="410" y="0" width="100" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Приєднана абонована потужність Р, кВт]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexFour" x="410" y="205" width="100" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[4]]></text>
			</staticText>
			<staticText>
				<reportElement key="statMoneyIncomeByConnectionAgreement" x="510" y="0" width="100" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Надходження коштів за договором про приєднання, тис. грн.]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexSix" x="510" y="205" width="100" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[5]]></text>
			</staticText>
			<staticText>
				<reportElement key="statTensionDegreeInConnectionPoint" mode="Transparent" x="610" y="0" width="100" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Ступінь напруги в точці приєднання, кВ.]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexSeven" x="610" y="205" width="100" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[6]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexEight" x="830" y="205" width="130" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[8]]></text>
			</staticText>
			<staticText>
				<reportElement key="statPointOfSupplement" x="830" y="0" width="130" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Точка забезпечення потужності: назва лінії електропередачі та номер опори (відстань до кабельної врізки) та/або назва (номер) підстанції згідно із системою кодифікації назв]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuilding" x="960" y="0" width="280" height="100"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Необхідність будівництва / реконструкції підстанції напругою U, кв. (з переліком відповідних робіт: заміна трансформатора, вимикача, розподільчого пристрою тощо) за ступенями напруги]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexNine" x="960" y="205" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[9]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTen" x="1030" y="205" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[10]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexEleven" x="1100" y="205" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[11]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTwelve" x="1170" y="205" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[12]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuildingLine" x="1400" y="0" width="280" height="100"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Необхідність будівництва / реконструкції лінії електропередачі у км напругою U, кВ (із зазначенням типу ліній електропередачі: повітряна лінія або кабельна лінія) за ступенями]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexThirteen" x="1400" y="205" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[15]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexFourteen" x="1470" y="205" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[16]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexFifteen" x="1540" y="205" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[17]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuilding" x="960" y="100" width="70" height="105"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[110(150)/35/10(6)]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuilding" x="1030" y="100" width="70" height="105"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[110(150)
/10(6)]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuilding" x="1100" y="100" width="70" height="105"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[35/10(6)]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuilding" x="1170" y="100" width="70" height="105"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[10(6)/0.4]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuildingLine" x="1400" y="100" width="70" height="105"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[110(150)]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuildingLine" x="1470" y="100" width="70" height="105"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[35]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuildingLine" x="1540" y="100" width="70" height="105"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[10(6)]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexSixteen" x="1610" y="205" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[18]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuildingLine" x="1610" y="100" width="70" height="105"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[0.4]]></text>
			</staticText>
			<staticText>
				<reportElement key="statFactCapitalCosts" x="1890" y="0" width="100" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Фактичні капітальні витрати на приєднання Вфакт. кап., тис. грн.]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexSeventeen" x="1890" y="205" width="100" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[22]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexEighteen" x="1990" y="205" width="100" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[23]]></text>
			</staticText>
			<staticText>
				<reportElement key="statFactCosts" x="1990" y="0" width="100" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Фактичні витрати на приєднання, що формують виробничу собівартість Вфакт. соб., тис. грн.]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexEighteen" x="2090" y="205" width="100" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[24]]></text>
			</staticText>
			<staticText>
				<reportElement key="statCostOfDevelopment" x="2090" y="0" width="100" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Фактичні витрати на обладнання засобів комерційного обліку електричної енергії, тис. грн]]></text>
			</staticText>
			<staticText>
				<reportElement key="statUnmount" x="2190" y="0" width="100" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Оприбуткована вартість демонтованого устаткування та обладнання, яке підлягає подальшому використанню]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTwenty" x="2190" y="205" width="100" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[25]]></text>
			</staticText>
			<staticText>
				<reportElement key="statAmountOfReturnFinancialHelp" x="2290" y="0" width="60" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Ккi]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTwentyOne" x="2290" y="205" width="60" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[26]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTwentyTwo" x="2350" y="205" width="60" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[27]]></text>
			</staticText>
			<staticText>
				<reportElement key="statAmountOfFinancing" x="2350" y="0" width="60" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Кнi]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTwentyThree" x="2410" y="205" width="60" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[28]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTwentyFour" x="2470" y="205" width="60" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[29]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTwentyFive" x="2530" y="205" width="60" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[30]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTwentySix" x="2590" y="205" width="60" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[31]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTwentySeven" x="2650" y="205" width="60" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[32]]></text>
			</staticText>
			<staticText>
				<reportElement key="statMinimalReserve" x="2770" y="0" width="344" height="120"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Поля для аналізу ]]></text>
			</staticText>
			<staticText>
				<reportElement key="statMinimalReservePeak" x="2770" y="120" width="100" height="118"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Прибуток]]></text>
			</staticText>
			<staticText>
				<reportElement key="statMinimalReservePeak" x="2870" y="120" width="244" height="118"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Формула прибутку]]></text>
			</staticText>
			<staticText>
				<reportElement key="statMinimalReservePeak" x="3114" y="0" width="86" height="238"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Особовий рахунок]]></text>
			</staticText>
			<staticText>
				<reportElement key="statMinimalReservePeak" x="3200" y="0" width="80" height="238"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Тип замовника]]></text>
			</staticText>
			<staticText>
				<reportElement key="statMinimalReservePeak" x="3280" y="0" width="80" height="238"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Бух статус]]></text>
			</staticText>
			<staticText>
				<reportElement key="statMinimalReservePeak" x="3440" y="0" width="210" height="238"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[ПС 150-110/35-27/10-6кВ]]></text>
			</staticText>
			<staticText>
				<reportElement key="statMinimalReservePeak" x="3650" y="0" width="210" height="238"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[ПС 35-27/10-6кВ]]></text>
			</staticText>
			<staticText>
				<reportElement key="statMinimalReservePeak" x="3860" y="0" width="120" height="238"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Підрозділ]]></text>
			</staticText>
			<staticText>
				<reportElement key="statMinimalReservePeak" x="3980" y="0" width="300" height="238"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Ставка плати]]></text>
			</staticText>
			<staticText>
				<reportElement key="statTensionDegreeInConnectionPoint" mode="Transparent" x="710" y="0" width="120" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Вартість проектної документації на будівництво електричних мереж від точки забезпечення потужності до межі балансової належності, тис. грн.]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexSeven" mode="Opaque" x="710" y="205" width="120" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[7]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuilding" x="1240" y="0" width="160" height="100"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Фактичні капітальні витрати на будівництво / реконструкцію підстанцій]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuilding" x="1240" y="100" width="80" height="105"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Основні мережі 110(150)-35 кВ,
Вроз, тис.грн
]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuilding" x="1320" y="100" width="80" height="105"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[20(10)6/0,4, Вфакт.тр, тис.грн]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTwelve" mode="Opaque" x="1240" y="205" width="80" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[13]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTwelve" mode="Opaque" x="1320" y="205" width="80" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[14]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuildingLine" x="1680" y="0" width="210" height="100"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Фактичні капітальні витрати на будівництво / реконструкцію ліній електропередавання Вфакт.лін, тис.грн]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuildingLine" x="1680" y="100" width="70" height="105"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Основні мережі 110(150)-35 кВ]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuildingLine" x="1750" y="100" width="70" height="105"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[20(10)6 кВ]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNecessityOfBuildingLine" x="1820" y="100" width="70" height="105"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[0,4(0,23)]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexSixteen" mode="Opaque" x="1680" y="205" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[19]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexSixteen" mode="Opaque" x="1750" y="205" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[20]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexSixteen" mode="Opaque" x="1820" y="205" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[21]]></text>
			</staticText>
			<staticText>
				<reportElement key="statAmountOfFinancing" x="2410" y="0" width="60" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Кфi]]></text>
			</staticText>
			<staticText>
				<reportElement key="statAmountOfFinancing" x="2470" y="0" width="60" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[КЗТi]]></text>
			</staticText>
			<staticText>
				<reportElement key="statAmountOfFinancing" x="2530" y="0" width="60" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Кмісцi nestand]]></text>
			</staticText>
			<staticText>
				<reportElement key="statAmountOfFinancing" x="2590" y="0" width="60" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Ксвi]]></text>
			</staticText>
			<staticText>
				<reportElement key="statAmountOfFinancing" x="2650" y="0" width="60" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Рi(кол.4)*Ккi*Кнi*Кфi]]></text>
			</staticText>
			<staticText>
				<reportElement key="statAmountOfFinancing" x="2710" y="0" width="60" height="205"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Рi(кол.4)*Ккi*Кнi*КЗТi*Кмісцi*Ксвi]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexTwentySeven" x="2710" y="205" width="60" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[33]]></text>
			</staticText>
			<staticText>
				<reportElement key="statMinimalReservePeak" x="3360" y="0" width="80" height="238"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Дата проведення акту виконаних робіт (з замовником)]]></text>
			</staticText>
			<staticText>
				<reportElement key="statAmountOfFinancing" x="4280" y="0" width="60" height="238"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Дата останнього акту ТО, КБ, РМ]]></text>
			</staticText>
			<staticText>
				<reportElement key="statAmountOfFinancing" x="4340" y="0" width="60" height="238"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Існуюча потужність кВт]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="30" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNumberAndDateOfAgreement" stretchType="RelativeToTallestObject" x="50" y="0" width="180" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
					<paragraph lineSpacing="1_1_2"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{contractnumber}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNumber" stretchType="RelativeToTallestObject" x="0" y="0" width="50" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{COLUMN_COUNT}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtPartner" stretchType="RelativeToTallestObject" x="230" y="0" width="180" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{partnername}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtCapacity" stretchType="RelativeToTallestObject" x="410" y="0" width="100" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{power}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtMoneyIncomeByConnectionAgreement" stretchType="RelativeToTallestObject" x="510" y="0" width="100" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{sum_calculated}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtTensionDegreeInConnectionPoint" stretchType="RelativeToTallestObject" x="610" y="0" width="100" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{voltageservices}
/*((com.ksoe.energynet.reports.common.FINScriptlet)
    $P{REPORT_SCRIPTLET}).getTension_pointFromCNByCNPackCode($F{cnpackcode} , $F{cnsubsystemtyperefcode})*/]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtTensionDegreeInConnectionPoint" stretchType="RelativeToTallestObject" x="830" y="0" width="130" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{connectionpowerplaces}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNecessityOfBuilding" stretchType="RelativeToTallestObject" x="960" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{countTP150}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNecessityOfBuilding" stretchType="RelativeToTallestObject" x="1030" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{countTP110}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNecessityOfBuilding" stretchType="RelativeToTallestObject" x="1100" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{enplanworkstate_ps_35_110_150}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNecessityOfBuilding" stretchType="RelativeToTallestObject" x="1170" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{enplanworkstate_ps_10_6_04}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtTensionDegreeInConnectionPoint" stretchType="RelativeToTallestObject" x="1400" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{countLine150}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtTensionDegreeInConnectionPoint" stretchType="RelativeToTallestObject" x="1470" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{enplanworkstate_pl_35_150}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtTensionDegreeInConnectionPoint" stretchType="RelativeToTallestObject" x="1540" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{enplanworkstate_pl_10_6}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtTensionDegreeInConnectionPoint" stretchType="RelativeToTallestObject" x="1610" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{enplanworkstate_pl_kl_04}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtCostOfDevelopment" stretchType="RelativeToTallestObject" x="2090" y="0" width="100" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtAmountOfReturnFinancialHelp" stretchType="RelativeToTallestObject" x="2290" y="0" width="60" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{kki}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtAmountOfFinancing" stretchType="RelativeToTallestObject" x="2350" y="0" width="60" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{kni}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtAbonCapacityGrowth" stretchType="RelativeToTallestObject" x="2470" y="0" width="60" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{connectionkindrefcode}.doubleValue() == 1  ? null :
$F{kzti_nonstandard}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtAbonCapacityReserve" stretchType="RelativeToTallestObject" x="2590" y="0" width="60" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{connectionkindrefcode}.doubleValue() == 1  ? null :
$F{ksvi_nonstandard}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtMinimalReserveNight" stretchType="RelativeToTallestObject" x="2650" y="0" width="60" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{connectionkindrefcode}.doubleValue() == 1  ?
$F{resultStandardKoef} : null]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtMinimalReserveHalfPeak" stretchType="RelativeToTallestObject" x="2710" y="0" width="60" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{connectionkindrefcode}.doubleValue() == 1  ? null :
$F{resultNonStandardKoef}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtFactCapitalCosts" stretchType="RelativeToTallestObject" x="1890" y="0" width="100" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{capital}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtFactCosts" stretchType="RelativeToTallestObject" x="1990" y="0" width="100" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{costs}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtUnmount" stretchType="RelativeToTallestObject" x="2190" y="0" width="100" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{unmount}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtFactCapitalCosts" stretchType="RelativeToTallestObject" x="2770" y="0" width="100" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{profit}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtFactCapitalCosts" stretchType="RelativeToTallestObject" x="2870" y="0" width="244" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{profit_formula}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtMinimalReservePeak" stretchType="RelativeToTallestObject" x="3114" y="0" width="86" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{personalaccountnumber}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtMinimalReservePeak" stretchType="RelativeToTallestObject" x="3200" y="0" width="80" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{contragenttype}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtMinimalReservePeak" stretchType="RelativeToTallestObject" x="3280" y="0" width="80" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{buhstatusname}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtMinimalReservePeak" stretchType="RelativeToTallestObject" x="3440" y="0" width="210" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nodes_plainlist_normal_s150}
/*((com.ksoe.energynet.reports.common.FINScriptlet)
    $P{REPORT_SCRIPTLET}).getSubsNameByCNPackCode($F{cnpackcode} , $F{cnsubsystemtyperefcode},1)*/]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtMinimalReservePeak" stretchType="RelativeToTallestObject" x="3650" y="0" width="210" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nodes_plainlist_normal_s35}
/*((com.ksoe.energynet.reports.common.FINScriptlet)
    $P{REPORT_SCRIPTLET}).getSubsNameByCNPackCode($F{cnpackcode} , $F{cnsubsystemtyperefcode},2)*/]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtMinimalReservePeak" stretchType="RelativeToTallestObject" x="3860" y="0" width="120" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{depname}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtMinimalReservePeak" stretchType="RelativeToTallestObject" x="3980" y="0" width="300" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{stavka}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNecessityOfBuilding" stretchType="RelativeToTallestObject" x="1240" y="0" width="80" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{sum_capital_tp_110_150}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNecessityOfBuilding" stretchType="RelativeToTallestObject" x="1320" y="0" width="80" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{sum_capital_tp_20_10}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtTensionDegreeInConnectionPoint" stretchType="RelativeToTallestObject" x="1680" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{sum_capital_line_110_150}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtTensionDegreeInConnectionPoint" stretchType="RelativeToTallestObject" x="1750" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{sum_capital_line_10}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtTensionDegreeInConnectionPoint" stretchType="RelativeToTallestObject" x="1820" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{sum_capital_line_04}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtTensionDegreeInConnectionPoint" stretchType="RelativeToTallestObject" x="710" y="0" width="120" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{sum_project}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtAmountOfFinancing" stretchType="RelativeToTallestObject" x="2410" y="0" width="60" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{connectionkindrefcode}.doubleValue() == 1  ?
$F{kfi} : null]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtAbonCapacityGrowth" stretchType="RelativeToTallestObject" x="2530" y="0" width="60" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{connectionkindrefcode}.doubleValue() == 1  ? null :
$F{kmisci_nonstandard}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtMinimalReservePeak" stretchType="RelativeToTallestObject" x="3360" y="0" width="80" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{dateprov}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtMinimalReserveHalfPeak" stretchType="RelativeToTallestObject" x="4280" y="0" width="60" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[new SimpleDateFormat("dd.MM.yyyy").format($F{maxdateact})]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtMinimalReserveHalfPeak" stretchType="RelativeToTallestObject" x="4340" y="0" width="60" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{tycurrentpower}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
	<noData>
		<band height="50">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtPartner" stretchType="RelativeToTallestObject" x="0" y="0" width="710" height="50"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="24"/>
				</textElement>
				<textFieldExpression><![CDATA["Немає даних для обраних параметрів " +
"\n" + " за період: " +
" з " + new SimpleDateFormat("dd.MM.yyyy").format($P{dateStart}) + " по "
+ new SimpleDateFormat("dd.MM.yyyy").format($P{dateFinal})
/*Місто / село*/
+ "\n Ознака місто / село: " + ( $P{isCityVillage} == 0 ? "Всі" :
                                                    ( $P{isCityVillage} == 1 ? "Місто" : "Село" ) )
                                                /*Місто / село*/
+ "\n Тип приєднання: " + ( $P{isStandardNonStandard} == 0 ? "Всі" :
                                                    ( $P{isStandardNonStandard} == 1 ? "Стандартне" : "Нестандартне" ) )]]></textFieldExpression>
			</textField>
		</band>
	</noData>
</jasperReport>
