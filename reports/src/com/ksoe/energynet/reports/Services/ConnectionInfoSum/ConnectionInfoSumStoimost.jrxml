<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ConnectionInfoSumStoimost" pageWidth="3000" pageHeight="900" orientation="Landscape" whenNoDataType="NoDataSection" columnWidth="2940" leftMargin="30" rightMargin="30" topMargin="20" bottomMargin="20" isIgnorePagination="true">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="0.9982500000000005"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="dateStart" class="java.util.Date">
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="dateFinal" class="java.util.Date">
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select
 sum(priednana_potujnost)::numeric(15,3) as priednana_potujnost ,
 sum(vsogo_nadishlo_koshtiv)::numeric(15,3) as vsogo_nadishlo_koshtiv ,
 (sum(vitrati_na_vikonannya_priednannya)/1000)::numeric(15,3) as vitrati_na_vikonannya_priednannya ,
 (sum(vitrati_na_vikonannya_priednannya_podr_spos)/1000)::numeric(15,3) as vitrati_na_vikonannya_priednannya_podr_spos ,
 (sum(vitrati_na_vikonannya_priednannya_hoz_spos)/1000)::numeric(15,3) as vitrati_na_vikonannya_priednannya_hoz_spos ,
 (sum(vitrati_na_vikonannya_priednannya_only_materials)/1000)::numeric(15,3) as vitrati_na_vikonannya_priednannya_only_materials ,
 /* нестандартное присоед */
 sum(priednana_potujnost_nstnd)::numeric(15,3) as priednana_potujnost_nstnd ,
 sum(vsogo_nadishlo_koshtiv_nstnd)::numeric(15,3) as vsogo_nadishlo_koshtiv_nstnd,
 (sum(vitrati_na_vikonannya_priednannya_nstnd)/1000)::numeric(15,3) as vitrati_na_vikonannya_priednannya_nstnd,
 (sum(vitrati_na_vikonannya_priednannya_podr_spos_nstnd)/1000)::numeric(15,3) as vitrati_na_vikonannya_priednannya_podr_spos_nstnd,
 (sum(vitrati_na_vikonannya_priednannya_hoz_spos_nstnd)/1000)::numeric(15,3) as vitrati_na_vikonannya_priednannya_hoz_spos_nstnd,
 (sum(vitrati_na_vikonannya_priednannya_only_materials_nstnd)/1000)::numeric(15,3) as vitrati_na_vikonannya_priednannya_only_materials_nstnd ,
 /* невизначене присоед */
 sum(priednana_potujnost_neviznach)::numeric(15,3) as priednana_potujnost_neviznach ,
 sum(vsogo_nadishlo_koshtiv_neviznach)::numeric(15,3) as vsogo_nadishlo_koshtiv_neviznach ,
 (sum(vitrati_na_vikonannya_priednannya_neviznach)/1000)::numeric(15,3)  as vitrati_na_vikonannya_priednannya_neviznach ,
 (sum(vitrati_na_vikonannya_priednannya_podr_spos_neviznach)/1000)::numeric(15,3) as vitrati_na_vikonannya_priednannya_podr_spos_neviznach ,
 (sum(vitrati_na_vikonannya_priednannya_hoz_spos_neviznach)/1000)::numeric(15,3) as vitrati_na_vikonannya_priednannya_hoz_spos_neviznach ,
 (sum(vitrati_na_vikonannya_priednannya_only_materials_neviznach)/1000)::numeric(15,3) as vitrati_na_vikonannya_priednannya_only_materials_neviznach
from (
	select
	sum(priednana_potujnost)::numeric(15,3) as priednana_potujnost ,
	sum(vsogo_nadishlo_koshtiv)::numeric(15,3) as vsogo_nadishlo_koshtiv ,
	sum(vitrati_na_vikonannya_priednannya)::numeric(15,3) as vitrati_na_vikonannya_priednannya ,
	sum(vitrati_na_vikonannya_priednannya_podr_spos)::numeric(15,3) as vitrati_na_vikonannya_priednannya_podr_spos ,
	sum(vitrati_na_vikonannya_priednannya_hoz_spos)::numeric(15,3) as vitrati_na_vikonannya_priednannya_hoz_spos ,
	sum(vitrati_na_vikonannya_priednannya_only_materials)::numeric(15,3) as vitrati_na_vikonannya_priednannya_only_materials ,
	/* нестандартное присоед */
	0 as priednana_potujnost_nstnd ,
	0 as vsogo_nadishlo_koshtiv_nstnd ,
	0 as vitrati_na_vikonannya_priednannya_nstnd,
	0 as vitrati_na_vikonannya_priednannya_podr_spos_nstnd,
	0 as vitrati_na_vikonannya_priednannya_hoz_spos_nstnd,
	0 as vitrati_na_vikonannya_priednannya_only_materials_nstnd ,
	 /* невизначене присоед */
	0 as priednana_potujnost_neviznach ,
	0 as vsogo_nadishlo_koshtiv_neviznach ,
	0 as vitrati_na_vikonannya_priednannya_neviznach ,
	0 as vitrati_na_vikonannya_priednannya_podr_spos_neviznach ,
	0 as vitrati_na_vikonannya_priednannya_hoz_spos_neviznach ,
	0 as vitrati_na_vikonannya_priednannya_only_materials_neviznach
	from (

					select
					 contractnumberservices ,
					 nomer_ty,
					 data_ty ,
					case when  max_dateact between $P{dateStart} and $P{dateFinal} then tc_tyservicespower  else 0 end as priednana_potujnost ,
					case when  max_dateact between $P{dateStart} and $P{dateFinal} then sumgen_oplata else 0 end as vsogo_nadishlo_koshtiv ,
					case when  max_dateact between $P{dateStart} and $P{dateFinal} then capital else 0 end as vitrati_na_vikonannya_priednannya,
					case when  max_dateact between $P{dateStart} and $P{dateFinal} then capital_podryadniy_sposob else 0 end as vitrati_na_vikonannya_priednannya_podr_spos,
					case when  max_dateact between $P{dateStart} and $P{dateFinal} then capital_hoz_sposob else 0 end as vitrati_na_vikonannya_priednannya_hoz_spos,
					case when  max_dateact between $P{dateStart} and $P{dateFinal} then capital_only_materials else 0 end as vitrati_na_vikonannya_priednannya_only_materials
from (
							select
							 so.contractnumberservices ,
							 tob.numbergen as nomer_ty,
							 tob.dategen as data_ty ,
							 tob.numbergen as tob_numbergen ,
							 tob.dategen as tob_dategen ,
							 -------
							 (select max(a.dateact) from enact a where
									      a.acttyperefcode in ( 2, 3, 4 )
									      and a.code in (
													      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
													      select pl.code
														      from enplanwork pl, entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
														      where pl.code = t2p.planrefcode
														      and so2tc.techcondservrefcode = t2p.techconservicesrefcode
														      and so2tc.servicesobjectrefcode = so.code
															  and pl.typerefcode not in (8 , /*19 SUPP-74743 */ 20 , 22) /*SUPP-71512*/
													      )
									                 )
									     )  as max_dateact ,
							  round(cast(tc.tyservicespower as decimal), 2) as tc_tyservicespower ,
							  coalesce((select sum(p2so.sumgen)/1000 from enpayment2so p2so
										 where p2so.paymenttyperefcode in (1,2)
										 and  p2so.servicesobjectrefcode = so.code )
										  ,0)::numeric(15,3) as sumgen_oplata,
							  tob.tyservicespower as tob_tyservicespower
							  ,
			coalesce(( /*Капитальные затраты (проектирование)*/
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1

                    union all

                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal),2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and pw1.typerefcode = 19) as query2) as query
        )
        + /*SUPP-71612 добавить стоимость счетчика */ coalesce((select coalesce(sum(sc.cost), 0) as sum_by_act
											        from sccounter sc, enestimateitem es, enact2enplanwork ena2, enact a,
											             entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
											       where a.code = ena2.actrefcode
											         and sc.estimateitemrefcode = es.code
											         and t2p.planrefcode = ena2.plancode
											         and so2tc.techcondservrefcode = t2p.techconservicesrefcode
											         and so2tc.servicesobjectrefcode = so.code
											         and es.countfact <> 0
											         and es.kindrefcode = 1
											         and ena2.plancode = es.planrefcode ),0) ,0) as capital
, coalesce(( /* COLUMN Капитальные затраты подрядный способ */
        	select round(cast(sum(sums) as decimal), 2)
            from (
                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal),2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and pw1.typerefcode = 19) as query2) as query
 ),0) as capital_podryadniy_sposob
 , coalesce( ( /*COLUMN Капитальные затраты хоз способ*/
 select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1
             ) as query
 ) , 0) as capital_hoz_sposob
  , coalesce(( /*COLUMN Капитальные затраты только материалы*/
 select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act_only_materials(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1
             ) as query
 ) , 0) as capital_only_materials
	from
									enservicesobject as so
									inner join enservicesobject2techcondtnsservices as so2tc on so.code = so2tc.servicesobjectrefcode
							        inner join entechconditionsservcs as tc on so2tc.techcondservrefcode = tc.code
							        inner join encontragent as co on tc.code = co.techcondservicesrefcod
							        inner join entechconditionsobjcts as tob on co.techconobjectscode = tob.code
							        left join enconnectiontariffentr as tf on tc.tariffentryrefcode = tf.code
									left join enconnectiontariff as ct on tf.tariffrefcode = ct.code
									left join enpowerreliabilityctgr as pow on ct.categoryrefcode = pow.code
							    	left join ensettletype as st on pow.settletyperefcode = st.code
									left join enconnectionpowerpoint as cop on ct.powerpointrefcode = cop.code
									left join enconnectionphasity as pha on ct.phasityrefcode = pha.code
									left join enpriconnectiondata as pda on tc.code = pda.techcondservrefcode
							where
									 so.contracttyperefcode = 5
									 and so.contractkindrefcode = 1
									 and tc.connectionkindrefcode in (1,2)
							         and so.contractstatusrefcode not in (2,8) /*не скасовані чи відмінені*/
							         and coalesce(tc.connectionkindrefcode, -1) = 1 /*Тип приєднання - стандартне */
							         /* max дата акта РМ, КБ або ТО */
								       and
										(
										 (select max(a.dateact) from enact a where
										      a.acttyperefcode in ( 2, 3, 4 )
										      and a.code in (
														      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
														      select pl.code
															      from enplanwork pl, entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
															      where pl.code = t2p.planrefcode
															      and so2tc.techcondservrefcode = t2p.techconservicesrefcode
															      and so2tc.servicesobjectrefcode = so.code
																  and pl.typerefcode not in (8 , /*19 SUPP-74743 */ 20 , 22) /*SUPP-71512*/
														      )
										                 )
										     ) >=  $P{dateStart}
										 and
										 (select max(a.dateact) from enact a where
										      a.acttyperefcode in ( 2, 3, 4 )
										      and a.code in (
														      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
														      select pl.code
																      from enplanwork pl, entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
																      where pl.code = t2p.planrefcode
																      and so2tc.techcondservrefcode = t2p.techconservicesrefcode
																      and so2tc.servicesobjectrefcode = so.code
																	  and pl.typerefcode not in (8 , /*19 SUPP-74743 */  20 , 22) /*SUPP-71512*/
														      )
										                 )
										     ) <=  $P{dateFinal}
										)


					  union /**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**/


					select	 tc.contractnumber ,
							 tob.numbergen as nomer_ty,
							 tob.dategen as data_ty ,
							 tob.numbergen as tob_numbergen ,
							 tob.dategen as tob_dategen ,
							 -------
							 (select max(a.dateact) from enact a where
							      a.acttyperefcode in ( 2, 3, 4 )
							      and a.code in (
											      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
											      select pl.code
											      from enplanwork pl
											      where pl.elementrefcode = tc.elementcode
												  and pl.typerefcode not in (8 /*19 SUPP-74743 */ , 20 , 22) /*SUPP-71512*/
											      )
							                 )
							     )  as max_dateact ,
							  round(cast(tc.tyservicespower as decimal), 2) as tc_tyservicespower ,
							  coalesce((select sum(p2so.sumgen)/1000 from enpayment2so p2so
								 where p2so.paymenttyperefcode in (1,2)
								  and  p2so.servicesobjectrefcode in ( select s2t.servicesobjectrefcode from enservicesobject2techcondtnsservices s2t
								                                        where s2t.techcondservrefcode  = tc.code      )
								  )
								  ,0)::numeric(15,3) as sumgen_oplata,
							  tob.tyservicespower as tob_tyservicespower
			, coalesce(( /*Капитальные затраты (проектирование)*/
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1

                    union all

                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal), 2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and pw1.typerefcode = 19) as query2) as query
        ) + /*SUPP-71612 добавить стоимость счетчика */ coalesce((select coalesce(sum(sc.cost), 0) as sum_by_act
											        from sccounter sc, enestimateitem es, enact2enplanwork ena2, enact a,
											             entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
											       where a.code = ena2.actrefcode
											         and sc.estimateitemrefcode = es.code
											         and t2p.planrefcode = ena2.plancode
											         and so2tc.techcondservrefcode = t2p.techconservicesrefcode
											         and so2tc.techcondservrefcode = tc.code
											         and es.countfact <> 0
											         and es.kindrefcode = 1
											         and ena2.plancode = es.planrefcode ),0) ,0)as capital
, coalesce(( /*COLUMN Капитальные затраты подрядный способ */
        	select round(cast(sum(sums) as decimal), 2) from
               (
                    select round(cast(sum((select  fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal), 2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and pw1.typerefcode = 19) as query2) as query
),0)  as capital_podryadniy_sposob
, coalesce(( /*Капитальные затраты хоз способ  */
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1
        ) as query
),0)  as capital_hoz_sposob
, coalesce(( /*Капитальные затраты только материалы  */
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act_only_materials(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1
        ) as query
),0)  as capital_only_materials
						from
							entechconditionsservcs as tc
					        inner join encontragent as co on tc.code = co.techcondservicesrefcod
					        inner join entechconditionsobjcts as tob on co.techconobjectscode = tob.code
					        left join enconnectiontariffentr as tf on tc.tariffentryrefcode = tf.code
							left join enconnectiontariff as ct on tf.tariffrefcode = ct.code
							left join enpowerreliabilityctgr as pow on ct.categoryrefcode = pow.code
					    	left join ensettletype as st on pow.settletyperefcode = st.code
							left join enconnectionpowerpoint as cop on ct.powerpointrefcode = cop.code
							left join enconnectionphasity as pha on ct.phasityrefcode = pha.code
							left join enpriconnectiondata as pda on tc.code = pda.techcondservrefcode
						where
							tc.connectionkindrefcode in (1, 2)
							and tc.techcondservicestypecd in (1, 2)
							and tc.code not in (select s2t.techcondservrefcode from enservicesobject2techcondtnsservices s2t)
					        and coalesce(tc.connectionkindrefcode, -1) = 1 /*Тип приєднання - стандартне */
					        /* max дата акта РМ, КБ або ТО */
							and(
							 (select max(a.dateact) from enact a where
							      a.acttyperefcode in ( 2, 3, 4 )
							      and a.code in (
											      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
											      select pl.code
											      from enplanwork pl
											      where pl.elementrefcode = tc.elementcode
												  and pl.typerefcode not in (8 /*19 SUPP-74743 */ , 20 , 22) /*SUPP-71512*/
											      )
							                 )
							     ) >=  $P{dateStart}
							 and
							 (select max(a.dateact) from enact a where
							      a.acttyperefcode in ( 2, 3, 4 )
							      and a.code in (
											      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
											      select pl.code
											      from enplanwork pl
											      where pl.elementrefcode = tc.elementcode
												  and pl.typerefcode not in (8 /*19 SUPP-74743 */ , 20 , 22) /*SUPP-71512*/
											      )
							                 )
							     ) <=  $P{dateFinal}
							)

					) as q1
	) as q2


	union all

	select
	0 as priednana_potujnost ,
	0 as vsogo_nadishlo_koshtiv ,
	0 as vitrati_na_vikonannya_priednannya,
	0 as vitrati_na_vikonannya_priednannya_podr_spos,
	0 as vitrati_na_vikonannya_priednannya_hoz_spos,
	0 as vitrati_na_vikonannya_priednannya_only_materials,

	  /* нестандартное присоед */
	sum(priednana_potujnost)::numeric(15,3) as priednana_potujnost_nstnd ,
	sum(vsogo_nadishlo_koshtiv)::numeric(15,3) as vsogo_nadishlo_koshtiv_nstnd,
	sum(vitrati_na_vikonannya_priednannya)::numeric(15,3) as vitrati_na_vikonannya_priednannya_nstnd,
	sum(vitrati_na_vikonannya_priednannya_podr_spos)::numeric(15,3) as vitrati_na_vikonannya_priednannya_podr_spos_nstnd,
	sum(vitrati_na_vikonannya_priednannya_hoz_spos)::numeric(15,3) as vitrati_na_vikonannya_priednannya_hoz_spos_nstnd,
	sum(vitrati_na_vikonannya_priednannya_only_materials)::numeric(15,3) as vitrati_na_vikonannya_priednannya_only_materials_nstnd ,
	 /* невизначене присоед */
	0 as priednana_potujnost_neviznach ,
	0 as vsogo_nadishlo_koshtiv_neviznach ,
	0 as vitrati_na_vikonannya_priednannya_neviznach ,
	0 as vitrati_na_vikonannya_priednannya_podr_spos_neviznach ,
	0 as vitrati_na_vikonannya_priednannya_hoz_spos_neviznach ,
	0 as vitrati_na_vikonannya_priednannya_only_materials_neviznach
	from (

					select
					 contractnumberservices ,
					 nomer_ty,
					 data_ty ,
					 case when  max_dateact between $P{dateStart} and $P{dateFinal} then tc_tyservicespower  else 0 end as priednana_potujnost ,
					 case when  max_dateact between $P{dateStart} and $P{dateFinal} then sumgen_oplata else 0 end as vsogo_nadishlo_koshtiv ,
					 case when  max_dateact between $P{dateStart} and $P{dateFinal} then capital else 0 end as vitrati_na_vikonannya_priednannya,
					 case when  max_dateact between $P{dateStart} and $P{dateFinal} then capital_podryadniy_sposob else 0 end as vitrati_na_vikonannya_priednannya_podr_spos,
					 case when  max_dateact between $P{dateStart} and $P{dateFinal} then capital_hoz_sposob else 0 end as vitrati_na_vikonannya_priednannya_hoz_spos,
					 case when  max_dateact between $P{dateStart} and $P{dateFinal} then capital_only_materials else 0 end as vitrati_na_vikonannya_priednannya_only_materials
					from (
							select
							 tc.code as tccode ,
							 so.code as socode ,
							 so.contractnumberservices ,
							 tob.numbergen as nomer_ty,
							 tob.dategen as data_ty ,
							 tob.numbergen as tob_numbergen ,
							 tob.dategen as tob_dategen ,
							 -------
							 (select max(a.dateact) from enact a where
									      a.acttyperefcode in ( 2, 3, 4 )
									      and a.code in (
													      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
													      select pl.code
														      from enplanwork pl, entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
														      where pl.code = t2p.planrefcode
														      and so2tc.techcondservrefcode = t2p.techconservicesrefcode
														      and so2tc.servicesobjectrefcode = so.code
															  and pl.typerefcode not in (8 , /*19 SUPP-74743 */ 20 , 22) /*SUPP-71512*/
													      )
									                 )
									     )  as max_dateact ,
							  round(cast(tc.tyservicespower as decimal), 2) as tc_tyservicespower ,
							  coalesce((select sum(p2so.sumgen)/1000 from enpayment2so p2so
										 where p2so.paymenttyperefcode in (1,2)
										 and  p2so.servicesobjectrefcode = so.code )
										  ,0)::numeric(15,3) as sumgen_oplata,
							  tob.tyservicespower as tob_tyservicespower
							  ,
			coalesce(( /*COLUMN Капитальные затраты (проектирование)*/
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1

                    union all

                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal),2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and pw1.typerefcode = 19) as query2) as query
        )
        + /*SUPP-71612 добавить стоимость счетчика */ coalesce((select coalesce(sum(sc.cost), 0) as sum_by_act
											        from sccounter sc, enestimateitem es, enact2enplanwork ena2, enact a,
											             entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
											       where a.code = ena2.actrefcode
											         and sc.estimateitemrefcode = es.code
											         and t2p.planrefcode = ena2.plancode
											         and so2tc.techcondservrefcode = t2p.techconservicesrefcode
											         and so2tc.servicesobjectrefcode = so.code
											         and es.countfact <> 0
											         and es.kindrefcode = 1
											         and ena2.plancode = es.planrefcode ),0) ,0)  as capital
,coalesce(( /* COLUMN Капитальные затраты подрядный способ */
        	select round(cast(sum(sums) as decimal), 2)
            from (
                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal),2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and pw1.typerefcode = 19) as query2) as query
 ),0) as capital_podryadniy_sposob
  , coalesce(( /*COLUMN Капитальные затраты хоз способ*/
 select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1
             ) as query
 ),0) as capital_hoz_sposob
 , coalesce(( /*COLUMN Капитальные затраты только материалы*/
 select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act_only_materials(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1
             ) as query
 ),0) as capital_only_materials
								from
									enservicesobject as so
									inner join enservicesobject2techcondtnsservices as so2tc on so.code = so2tc.servicesobjectrefcode
							        inner join entechconditionsservcs as tc on so2tc.techcondservrefcode = tc.code
							        inner join encontragent as co on tc.code = co.techcondservicesrefcod
							        inner join entechconditionsobjcts as tob on co.techconobjectscode = tob.code
							        left join enconnectiontariffentr as tf on tc.tariffentryrefcode = tf.code
									left join enconnectiontariff as ct on tf.tariffrefcode = ct.code
									left join enpowerreliabilityctgr as pow on ct.categoryrefcode = pow.code
							    	left join ensettletype as st on pow.settletyperefcode = st.code
									left join enconnectionpowerpoint as cop on ct.powerpointrefcode = cop.code
									left join enconnectionphasity as pha on ct.phasityrefcode = pha.code
									left join enpriconnectiondata as pda on tc.code = pda.techcondservrefcode
							where
									 so.contracttyperefcode = 5
									 and so.contractkindrefcode = 1
							         and so.contractstatusrefcode not in (2,8) /*не скасовані чи відмінені*/
							         and coalesce(tc.connectionkindrefcode, -1) in (2,4) /*Тип приєднання - нестандартне */
							         /* max дата акта РМ, КБ або ТО */
								       and
										(
										 (select max(a.dateact) from enact a where
										      a.acttyperefcode in ( 2, 3, 4 )
										      and a.code in (
														      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
														      select pl.code
															      from enplanwork pl, entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
															      where pl.code = t2p.planrefcode
															      and so2tc.techcondservrefcode = t2p.techconservicesrefcode
															      and so2tc.servicesobjectrefcode = so.code
																  and pl.typerefcode not in (8 , /*19 SUPP-74743 */ 20 , 22) /*SUPP-71512*/
														      )
										                 )
										     ) >=  $P{dateStart}
										 and
										 (select max(a.dateact) from enact a where
										      a.acttyperefcode in ( 2, 3, 4 )
										      and a.code in (
														      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
														      select pl.code
																      from enplanwork pl, entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
																      where pl.code = t2p.planrefcode
																      and so2tc.techcondservrefcode = t2p.techconservicesrefcode
																      and so2tc.servicesobjectrefcode = so.code
																	  and pl.typerefcode not in (8 , /*19 SUPP-74743 */  20 , 22) /*SUPP-71512*/
														      )
										                 )
										     ) <=  $P{dateFinal}
										)

					  union /**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**/


					select   0 as tccode ,
							 0 as socode ,
							 tc.contractnumber ,
							 tob.numbergen as nomer_ty,
							 tob.dategen as data_ty ,
							 tob.numbergen as tob_numbergen ,
							 tob.dategen as tob_dategen ,
							 -------
							 (select max(a.dateact) from enact a where
							      a.acttyperefcode in ( 2, 3, 4 )
							      and a.code in (
											      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
											      select pl.code
											      from enplanwork pl
											      where pl.elementrefcode = tc.elementcode
												  and pl.typerefcode not in (8 /*19 SUPP-74743 */ , 20 , 22) /*SUPP-71512*/
											      )
							                 )
							     )  as max_dateact ,
							  round(cast(tc.tyservicespower as decimal), 2) as tc_tyservicespower ,
							  coalesce((select sum(p2so.sumgen)/1000 from enpayment2so p2so
								 where p2so.paymenttyperefcode in (1,2)
								  and  p2so.servicesobjectrefcode in ( select s2t.servicesobjectrefcode from enservicesobject2techcondtnsservices s2t
								                                        where s2t.techcondservrefcode  = tc.code      )
								  )
								  ,0)::numeric(15,3) as sumgen_oplata,
							  tob.tyservicespower as tob_tyservicespower
			, coalesce( ( /* COLUMN Капитальные затраты (проектирование)*/
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1

                    union all

                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal), 2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and pw1.typerefcode = 19) as query2) as query
        ) + /*SUPP-71612 добавить стоимость счетчика */ coalesce((select coalesce(sum(sc.cost), 0) as sum_by_act
											        from sccounter sc, enestimateitem es, enact2enplanwork ena2, enact a,
											             entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
											       where a.code = ena2.actrefcode
											         and sc.estimateitemrefcode = es.code
											         and t2p.planrefcode = ena2.plancode
											         and so2tc.techcondservrefcode = t2p.techconservicesrefcode
											         and so2tc.techcondservrefcode = tc.code
											         and es.countfact <> 0
											         and es.kindrefcode = 1
											         and ena2.plancode = es.planrefcode ),0) , 0) as capital
, coalesce(( /*COLUMN Капитальные затраты подрядный способ */
        	select round(cast(sum(sums) as decimal), 2) from
               (
                    select round(cast(sum((select  fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal), 2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and pw1.typerefcode = 19) as query2) as query
),0)  as capital_podryadniy_sposob
, coalesce( ( /*Капитальные затраты хоз способ  */
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1
        ) as query
) ,0)   as capital_hoz_sposob
,coalesce( ( /*Капитальные затраты только материалы  */
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act_only_materials(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1
        ) as query
) ,0)  as capital_only_materials
						from
							entechconditionsservcs as tc
					        inner join encontragent as co on tc.code = co.techcondservicesrefcod
					        inner join entechconditionsobjcts as tob on co.techconobjectscode = tob.code
					        left join enconnectiontariffentr as tf on tc.tariffentryrefcode = tf.code
							left join enconnectiontariff as ct on tf.tariffrefcode = ct.code
							left join enpowerreliabilityctgr as pow on ct.categoryrefcode = pow.code
					    	left join ensettletype as st on pow.settletyperefcode = st.code
							left join enconnectionpowerpoint as cop on ct.powerpointrefcode = cop.code
							left join enconnectionphasity as pha on ct.phasityrefcode = pha.code
							left join enpriconnectiondata as pda on tc.code = pda.techcondservrefcode
						where
							 tc.techcondservicestypecd in (1, 2)
							and tc.code not in (select s2t.techcondservrefcode from enservicesobject2techcondtnsservices s2t)
					        and coalesce(tc.connectionkindrefcode, -1) in (2,4) /*Тип приєднання - нестандартне */
					        /* max дата акта РМ, КБ або ТО */
							and(
							 (select max(a.dateact) from enact a where
							      a.acttyperefcode in ( 2, 3, 4 )
							      and a.code in (
											      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
											      select pl.code
											      from enplanwork pl
											      where pl.elementrefcode = tc.elementcode
												  and pl.typerefcode not in (8 /*19 SUPP-74743 */ , 20 , 22) /*SUPP-71512*/
											      )
							                 )
							     ) >=  $P{dateStart}
							 and
							 (select max(a.dateact) from enact a where
							      a.acttyperefcode in ( 2, 3, 4 )
							      and a.code in (
											      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
											      select pl.code
											      from enplanwork pl
											      where pl.elementrefcode = tc.elementcode
												  and pl.typerefcode not in (8 /*19 SUPP-74743 */ , 20 , 22) /*SUPP-71512*/
											      )
							                 )
							     ) <=  $P{dateFinal}
							)

					) as q1
	     ) as q2

union  /* невизначений тип приєднання */

select
	0 as priednana_potujnost ,
	0 as vsogo_nadishlo_koshtiv ,
	0 as vitrati_na_vikonannya_priednannya ,
	0 as vitrati_na_vikonannya_priednannya_podr_spos ,
	0 as vitrati_na_vikonannya_priednannya_hoz_spos ,
	0 as vitrati_na_vikonannya_priednannya_only_materials ,
	/* нестандартное присоед */
	0 as priednana_potujnost_nstnd ,
	0 as vsogo_nadishlo_koshtiv_nstnd ,
	0 as vitrati_na_vikonannya_priednannya_nstnd,
	0 as vitrati_na_vikonannya_priednannya_podr_spos_nstnd,
	0 as vitrati_na_vikonannya_priednannya_hoz_spos_nstnd,
	0 as vitrati_na_vikonannya_priednannya_only_materials_nstnd ,
	/* невизначене присоед */
	sum(priednana_potujnost)::numeric(15,3) as priednana_potujnost_neviznach ,
	sum(vsogo_nadishlo_koshtiv)::numeric(15,3) as vsogo_nadishlo_koshtiv_neviznach ,
	sum(vitrati_na_vikonannya_priednannya)::numeric(15,3) as vitrati_na_vikonannya_priednannya_neviznach ,
	sum(vitrati_na_vikonannya_priednannya_podr_spos)::numeric(15,3) as vitrati_na_vikonannya_priednannya_podr_spos_neviznach ,
	sum(vitrati_na_vikonannya_priednannya_hoz_spos)::numeric(15,3) as vitrati_na_vikonannya_priednannya_hoz_spos_neviznach ,
	sum(vitrati_na_vikonannya_priednannya_only_materials)::numeric(15,3) as vitrati_na_vikonannya_priednannya_only_materials_neviznach
	from (

					select
					 contractnumberservices ,
					 nomer_ty,
					 data_ty ,
					case when  max_dateact between $P{dateStart} and $P{dateFinal} then tc_tyservicespower  else 0 end as priednana_potujnost ,
					case when  max_dateact between $P{dateStart} and $P{dateFinal} then sumgen_oplata else 0 end as vsogo_nadishlo_koshtiv ,
					case when  max_dateact between $P{dateStart} and $P{dateFinal} then capital else 0 end as vitrati_na_vikonannya_priednannya,
					case when  max_dateact between $P{dateStart} and $P{dateFinal} then capital_podryadniy_sposob else 0 end as vitrati_na_vikonannya_priednannya_podr_spos,
					case when  max_dateact between $P{dateStart} and $P{dateFinal} then capital_hoz_sposob else 0 end as vitrati_na_vikonannya_priednannya_hoz_spos,
					case when  max_dateact between $P{dateStart} and $P{dateFinal} then capital_only_materials else 0 end as vitrati_na_vikonannya_priednannya_only_materials
from (
							select
							 so.contractnumberservices ,
							 tob.numbergen as nomer_ty,
							 tob.dategen as data_ty ,
							 tob.numbergen as tob_numbergen ,
							 tob.dategen as tob_dategen ,
							 -------
							 (select max(a.dateact) from enact a where
									      a.acttyperefcode in ( 2, 3, 4 )
									      and a.code in (
													      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
													      select pl.code
														      from enplanwork pl, entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
														      where pl.code = t2p.planrefcode
														      and so2tc.techcondservrefcode = t2p.techconservicesrefcode
														      and so2tc.servicesobjectrefcode = so.code
															  and pl.typerefcode not in (8 , /*19 SUPP-74743 */ 20 , 22) /*SUPP-71512*/
													      )
									                 )
									     )  as max_dateact ,
							  round(cast(tc.tyservicespower as decimal), 2) as tc_tyservicespower ,
							  coalesce((select sum(p2so.sumgen)/1000 from enpayment2so p2so
										 where p2so.paymenttyperefcode in (1,2)
										 and  p2so.servicesobjectrefcode = so.code )
										  ,0)::numeric(15,3) as sumgen_oplata,
							  tob.tyservicespower as tob_tyservicespower
							  ,
		coalesce(	( /*Капитальные затраты (проектирование)*/
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1

                    union all

                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal),2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and pw1.typerefcode = 19) as query2) as query
        )
        + /*SUPP-71612 добавить стоимость счетчика */ coalesce((select coalesce(sum(sc.cost), 0) as sum_by_act
											        from sccounter sc, enestimateitem es, enact2enplanwork ena2, enact a,
											             entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
											       where a.code = ena2.actrefcode
											         and sc.estimateitemrefcode = es.code
											         and t2p.planrefcode = ena2.plancode
											         and so2tc.techcondservrefcode = t2p.techconservicesrefcode
											         and so2tc.servicesobjectrefcode = so.code
											         and es.countfact <> 0
											         and es.kindrefcode = 1
											         and ena2.plancode = es.planrefcode ),0) ,0) as capital
, coalesce(( /* COLUMN Капитальные затраты подрядный способ */
        	select round(cast(sum(sums) as decimal), 2)
            from (
                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal),2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and pw1.typerefcode = 19) as query2) as query
 ),0) as capital_podryadniy_sposob
 , coalesce(( /*COLUMN Капитальные затраты хоз способ*/
 select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1
             ) as query
 ),0) as capital_hoz_sposob
  , coalesce(( /*COLUMN Капитальные затраты только материалы*/
 select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act_only_materials(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1
             ) as query
 ),0) as capital_only_materials
	from
									enservicesobject as so
									inner join enservicesobject2techcondtnsservices as so2tc on so.code = so2tc.servicesobjectrefcode
							        inner join entechconditionsservcs as tc on so2tc.techcondservrefcode = tc.code
							        inner join encontragent as co on tc.code = co.techcondservicesrefcod
							        inner join entechconditionsobjcts as tob on co.techconobjectscode = tob.code
							        left join enconnectiontariffentr as tf on tc.tariffentryrefcode = tf.code
									left join enconnectiontariff as ct on tf.tariffrefcode = ct.code
									left join enpowerreliabilityctgr as pow on ct.categoryrefcode = pow.code
							    	left join ensettletype as st on pow.settletyperefcode = st.code
									left join enconnectionpowerpoint as cop on ct.powerpointrefcode = cop.code
									left join enconnectionphasity as pha on ct.phasityrefcode = pha.code
									left join enpriconnectiondata as pda on tc.code = pda.techcondservrefcode
							where
									 so.contracttyperefcode = 5
									 and so.contractkindrefcode = 1
							         and so.contractstatusrefcode not in (2,8) /*не скасовані чи відмінені*/
							         and coalesce(tc.connectionkindrefcode, -1) = 3 /*Тип приєднання - невизначене */
							         /* max дата акта РМ, КБ або ТО */
								       and
										(
										 (select max(a.dateact) from enact a where
										      a.acttyperefcode in ( 2, 3, 4 )
										      and a.code in (
														      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
														      select pl.code
															      from enplanwork pl, entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
															      where pl.code = t2p.planrefcode
															      and so2tc.techcondservrefcode = t2p.techconservicesrefcode
															      and so2tc.servicesobjectrefcode = so.code
																  and pl.typerefcode not in (8 , /*19 SUPP-74743 */ 20 , 22) /*SUPP-71512*/
														      )
										                 )
										     ) >=  $P{dateStart}
										 and
										 (select max(a.dateact) from enact a where
										      a.acttyperefcode in ( 2, 3, 4 )
										      and a.code in (
														      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
														      select pl.code
																      from enplanwork pl, entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
																      where pl.code = t2p.planrefcode
																      and so2tc.techcondservrefcode = t2p.techconservicesrefcode
																      and so2tc.servicesobjectrefcode = so.code
																	  and pl.typerefcode not in (8 , /*19 SUPP-74743 */  20 , 22) /*SUPP-71512*/
														      )
										                 )
										     ) <=  $P{dateFinal}
										)


					  union /**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**/


					select	 tc.contractnumber ,
							 tob.numbergen as nomer_ty,
							 tob.dategen as data_ty ,
							 tob.numbergen as tob_numbergen ,
							 tob.dategen as tob_dategen ,
							 -------
							 (select max(a.dateact) from enact a where
							      a.acttyperefcode in ( 2, 3, 4 )
							      and a.code in (
											      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
											      select pl.code
											      from enplanwork pl
											      where pl.elementrefcode = tc.elementcode
												  and pl.typerefcode not in (8 /*19 SUPP-74743 */ , 20 , 22) /*SUPP-71512*/
											      )
							                 )
							     )  as max_dateact ,
							  round(cast(tc.tyservicespower as decimal), 2) as tc_tyservicespower ,
							  coalesce((select sum(p2so.sumgen)/1000 from enpayment2so p2so
								 where p2so.paymenttyperefcode in (1,2)
								  and  p2so.servicesobjectrefcode in ( select s2t.servicesobjectrefcode from enservicesobject2techcondtnsservices s2t
								                                        where s2t.techcondservrefcode  = tc.code      )
								  )
								  ,0)::numeric(15,3) as sumgen_oplata,
							  tob.tyservicespower as tob_tyservicespower
			, coalesce( ( /*Капитальные затраты (проектирование)*/
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1

                    union all

                    select round(cast(sum((select /*fo2.sumnds + SUPP-72680 */ fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal), 2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and pw1.typerefcode = 19) as query2) as query
        ) + /*SUPP-71612 добавить стоимость счетчика */ coalesce((select coalesce(sum(sc.cost), 0) as sum_by_act
											        from sccounter sc, enestimateitem es, enact2enplanwork ena2, enact a,
											             entechcond2planwork t2p, enservicesobject2techcondtnsservices so2tc
											       where a.code = ena2.actrefcode
											         and sc.estimateitemrefcode = es.code
											         and t2p.planrefcode = ena2.plancode
											         and so2tc.techcondservrefcode = t2p.techconservicesrefcode
											         and so2tc.techcondservrefcode = tc.code
											         and es.countfact <> 0
											         and es.kindrefcode = 1
											         and ena2.plancode = es.planrefcode ),0) ,0) as capital
, coalesce(( /*COLUMN Капитальные затраты подрядный способ */
        	select round(cast(sum(sums) as decimal), 2) from
               (
                    select round(cast(sum((select  fo2.sumwithoutnds from rqfkorder as fo2 where fo2.code = query2.code)) as decimal), 2) as sums from
                    (
                    select distinct fo1.code from
					rqfkorder as fo1 inner join
					rqfkorder2planfact as fopw1 on fo1.code = fopw1.fkordercode
					inner join entechcond2planwork as tcpw1 on fopw1.factcode = tcpw1.planrefcode
                    inner join enplanwork as pw1 on tcpw1.planrefcode = pw1.code
					where
					tcpw1.techconservicesrefcode = tc.code
                    and pw1.typerefcode = 19) as query2) as query
),0)  as capital_podryadniy_sposob
, coalesce( ( /*Капитальные затраты хоз способ  */
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1
        ) as query
) ,0) as capital_hoz_sposob
, coalesce( ( /*Капитальные затраты только материалы  */
        	select round(cast(sum(sums) as decimal), 2) from
        	(select
            	sum(net.get_sum_by_act_only_materials(act_code)) as sums
            from (
            	select distinct
    				ac1.code as act_code
    			from
                	entechcond2planwork as tcpw1
					inner join enact2enplanwork as acpw1 on tcpw1.planrefcode = acpw1.plancode
					inner join enact as ac1 on acpw1.actrefcode = ac1.code
				where
					tcpw1.techconservicesrefcode = tc.code
					and ac1.acttyperefcode in (29, 1, 2, 4 , 3/*SUPP-71612 добавить тип акта ТО*/ ) /*Проектування*/
                    ) as query1
        ) as query
) , 0)   as capital_only_materials
						from
							entechconditionsservcs as tc
					        inner join encontragent as co on tc.code = co.techcondservicesrefcod
					        inner join entechconditionsobjcts as tob on co.techconobjectscode = tob.code
					        left join enconnectiontariffentr as tf on tc.tariffentryrefcode = tf.code
							left join enconnectiontariff as ct on tf.tariffrefcode = ct.code
							left join enpowerreliabilityctgr as pow on ct.categoryrefcode = pow.code
					    	left join ensettletype as st on pow.settletyperefcode = st.code
							left join enconnectionpowerpoint as cop on ct.powerpointrefcode = cop.code
							left join enconnectionphasity as pha on ct.phasityrefcode = pha.code
							left join enpriconnectiondata as pda on tc.code = pda.techcondservrefcode
						where
							tc.techcondservicestypecd in (1, 2)
							and tc.code not in (select s2t.techcondservrefcode from enservicesobject2techcondtnsservices s2t)
					        and coalesce(tc.connectionkindrefcode, -1) = 3 /*Тип приєднання - невизначене */
					        /* max дата акта РМ, КБ або ТО */
							and(
							 (select max(a.dateact) from enact a where
							      a.acttyperefcode in ( 2, 3, 4 )
							      and a.code in (
											      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
											      select pl.code
											      from enplanwork pl
											      where pl.elementrefcode = tc.elementcode
												  and pl.typerefcode not in (8 /*19 SUPP-74743 */ , 20 , 22) /*SUPP-71512*/
											      )
							                 )
							     ) >=  $P{dateStart}
							 and
							 (select max(a.dateact) from enact a where
							      a.acttyperefcode in ( 2, 3, 4 )
							      and a.code in (
											      select a2p.actrefcode from enact2enplanwork a2p where a2p.plancode in (
											      select pl.code
											      from enplanwork pl
											      where pl.elementrefcode = tc.elementcode
												  and pl.typerefcode not in (8 /*19 SUPP-74743 */ , 20 , 22) /*SUPP-71512*/
											      )
							                 )
							     ) <=  $P{dateFinal}
							)

					) as q1
	) as q2
) as q3]]>
	</queryString>
	<field name="priednana_potujnost" class="java.math.BigDecimal"/>
	<field name="vsogo_nadishlo_koshtiv" class="java.math.BigDecimal"/>
	<field name="vitrati_na_vikonannya_priednannya" class="java.math.BigDecimal"/>
	<field name="vitrati_na_vikonannya_priednannya_podr_spos" class="java.math.BigDecimal"/>
	<field name="vitrati_na_vikonannya_priednannya_hoz_spos" class="java.math.BigDecimal"/>
	<field name="vitrati_na_vikonannya_priednannya_only_materials" class="java.math.BigDecimal"/>
	<field name="priednana_potujnost_nstnd" class="java.math.BigDecimal"/>
	<field name="vsogo_nadishlo_koshtiv_nstnd" class="java.math.BigDecimal"/>
	<field name="vitrati_na_vikonannya_priednannya_nstnd" class="java.math.BigDecimal"/>
	<field name="vitrati_na_vikonannya_priednannya_podr_spos_nstnd" class="java.math.BigDecimal"/>
	<field name="vitrati_na_vikonannya_priednannya_hoz_spos_nstnd" class="java.math.BigDecimal"/>
	<field name="vitrati_na_vikonannya_priednannya_only_materials_nstnd" class="java.math.BigDecimal"/>
	<field name="priednana_potujnost_neviznach" class="java.math.BigDecimal"/>
	<field name="vsogo_nadishlo_koshtiv_neviznach" class="java.math.BigDecimal"/>
	<field name="vitrati_na_vikonannya_priednannya_neviznach" class="java.math.BigDecimal"/>
	<field name="vitrati_na_vikonannya_priednannya_podr_spos_neviznach" class="java.math.BigDecimal"/>
	<field name="vitrati_na_vikonannya_priednannya_hoz_spos_neviznach" class="java.math.BigDecimal"/>
	<field name="vitrati_na_vikonannya_priednannya_only_materials_neviznach" class="java.math.BigDecimal"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="154" splitType="Stretch">
			<textField isBlankWhenNull="false">
				<reportElement key="textField-18" x="0" y="0" width="520" height="154"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="20"/>
				</textElement>
				<textFieldExpression><![CDATA[" Інформація щодо вартісних показників від виконання приєднань \n " +
" електроустановок  замовників до електричних мереж АТ \" Херсонобленерго\"  \n" +
" з " + new SimpleDateFormat("dd.MM.yyyy").format($P{dateStart}) + " по " + new SimpleDateFormat("dd.MM.yyyy").format($P{dateFinal})]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="168" splitType="Stretch">
			<staticText>
				<reportElement key="statNumber" x="0" y="0" width="100" height="120"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Перелік інформації]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="0" y="120" width="100" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[1]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNumberAndDateOfAgreement" x="100" y="0" width="70" height="120"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Приєднана потужність]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNumberAndDateOfAgreement" x="170" y="0" width="70" height="120"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Всього надійшло коштів (по приєднаній потужності)]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNumberAndDateOfAgreement" x="240" y="0" width="70" height="120"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Витрати на виконання приєднання ВСЬОГО]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNumberAndDateOfAgreement" x="310" y="0" width="70" height="120"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[у т.ч. Витрати на підряд ]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNumberAndDateOfAgreement" x="380" y="0" width="70" height="120"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[у т.ч. Витрати на госп. спосіб]]></text>
			</staticText>
			<staticText>
				<reportElement key="statNumberAndDateOfAgreement" x="450" y="0" width="70" height="120"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[у т.ч. ТМЦ (без ПММ)]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="100" y="120" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[2]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="170" y="120" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[3]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="240" y="120" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[4]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="310" y="120" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[5]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="380" y="120" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[6]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="450" y="120" width="70" height="33"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[7]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="450" y="153" width="70" height="15"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[тис.грн.]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="170" y="153" width="70" height="15"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[тис.грн.]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="310" y="153" width="70" height="15"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[тис.грн.]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="0" y="153" width="100" height="15"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[Од. виміру]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="100" y="153" width="70" height="15"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[кВт]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="240" y="153" width="70" height="15"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[тис.грн.]]></text>
			</staticText>
			<staticText>
				<reportElement key="statIndexOne" x="380" y="153" width="70" height="15"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<text><![CDATA[тис.грн.]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="30" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNumber" stretchType="RelativeToTallestObject" x="0" y="0" width="100" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA["Стандартне"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNumber" stretchType="RelativeToTallestObject" x="100" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{priednana_potujnost}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNumber" stretchType="RelativeToTallestObject" x="170" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{vsogo_nadishlo_koshtiv}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNumber" stretchType="RelativeToTallestObject" x="240" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{vitrati_na_vikonannya_priednannya}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNumber" stretchType="RelativeToTallestObject" x="310" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{vitrati_na_vikonannya_priednannya_podr_spos}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNumber" stretchType="RelativeToTallestObject" x="380" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{vitrati_na_vikonannya_priednannya_hoz_spos}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtNumber" stretchType="RelativeToTallestObject" x="450" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{vitrati_na_vikonannya_priednannya_only_materials}]]></textFieldExpression>
			</textField>
		</band>
		<band height="30">
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="170" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{vsogo_nadishlo_koshtiv_nstnd}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="380" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{vitrati_na_vikonannya_priednannya_hoz_spos_nstnd}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="240" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{vitrati_na_vikonannya_priednannya_nstnd}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="310" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{vitrati_na_vikonannya_priednannya_podr_spos_nstnd}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="450" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{vitrati_na_vikonannya_priednannya_only_materials_nstnd}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="100" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{priednana_potujnost_nstnd}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="0" y="0" width="100" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA["Нестандартне"]]></textFieldExpression>
			</textField>
		</band>
		<band height="30">
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="100" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="310" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="450" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="170" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="0" y="0" width="100" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA["Без методики"]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="240" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="txtNumber" positionType="Float" stretchType="RelativeToTallestObject" x="380" y="0" width="70" height="30"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Times New Roman" size="11"/>
				</textElement>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
	<noData>
		<band height="50">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="txtPartner" stretchType="RelativeToTallestObject" x="0" y="0" width="520" height="50"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="24"/>
				</textElement>
				<textFieldExpression><![CDATA["Немає даних для обраних параметрів "]]></textFieldExpression>
			</textField>
		</band>
	</noData>
</jasperReport>
